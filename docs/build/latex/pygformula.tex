%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{tgtermes}
\usepackage{tgheros}
\renewcommand{\ttdefault}{txtt}



\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=auto}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}


\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}



\title{Pygformula Documentation}
\date{Mar 27, 2024}
\release{0.0.1}
\author{}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}


\sphinxAtStartPar
The \sphinxhref{https://github.com/CausalInference/pygformula}{pygformula} is a python package that implements the parametric g\sphinxhyphen{}formula method
to estimate the effects of sustained treatment strategies from observational data with time\sphinxhyphen{}varying treatments, confounders, and outcomes \sphinxstepexplicit %
\begin{footnote}[1]\phantomsection\label{\thesphinxscope.1}%
\sphinxAtStartFootnote
Robins JM. A new approach to causal inference in mortality studies with a sustained exposure period—application to control of the healthy worker survivor effect. Mathematical modelling 1986;7(9\sphinxhyphen{}12):1393\sphinxhyphen{}512.
%
\end{footnote} \sphinxstepexplicit %
\begin{footnote}[2]\phantomsection\label{\thesphinxscope.2}%
\sphinxAtStartFootnote
Hernán MA, Robins JM (2020). Causal Inference: What If. Boca Raton: Chapman \& Hall/CRC.
%
\end{footnote}.

\sphinxAtStartPar
Specifically, this package implements the noniterative conditional expectation (NICE) estimator of parametric
g\sphinxhyphen{}formula which accommodates different types of covariates, different types of outcomes, different types of interventions, as well as more complicated scenarios
such as competing event, censoring event and visit process.

\sphinxAtStartPar
The goal of this package is to give an easy and convenient tool for users to perform data analysis based on the parametric g\sphinxhyphen{}formula method in python.
You can have a quick understanding of how to use the pygformula by going through a simple example in
{\hyperref[\detokenize{Get Started::doc}]{\sphinxcrossref{\DUrole{doc}{Get Started}}}}.
If you want to perform a more specific analysis, please see {\hyperref[\detokenize{Specifications/index::doc}]{\sphinxcrossref{\DUrole{doc}{Specifications}}}} in which you
will learn how to specify each module in the usage of the package.


\chapter{Installation}
\label{\detokenize{Installation:installation}}\label{\detokenize{Installation::doc}}

\section{Requirements}
\label{\detokenize{Installation:requirements}}
\sphinxAtStartPar
The package is supported by python 3. It requires these necessary dependencies:
\begin{itemize}
\item {} 
\sphinxAtStartPar
joblib

\item {} 
\sphinxAtStartPar
lifelines

\item {} 
\sphinxAtStartPar
matplotlib

\item {} 
\sphinxAtStartPar
numpy

\item {} 
\sphinxAtStartPar
pandas

\item {} 
\sphinxAtStartPar
prettytable

\item {} 
\sphinxAtStartPar
scipy

\item {} 
\sphinxAtStartPar
statsmodels

\item {} 
\sphinxAtStartPar
tqdm

\end{itemize}

\sphinxAtStartPar
All the dependencies needed by the pygformula are listed in the file
\sphinxhref{https://github.com/CausalInference/pygformula/blob/master/requirements.txt}{“requirements.txt”} , users can
install them by:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pip} \PYG{n}{install} \PYG{o}{\PYGZhy{}}\PYG{n}{r} \PYG{n}{requirements}\PYG{o}{.}\PYG{n}{txt}
\end{sphinxVerbatim}


\section{Install pygformula}
\label{\detokenize{Installation:install-pygformula}}
\sphinxAtStartPar
Users can use the following command to install the pygformula package:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pip} \PYG{n}{install} \PYG{n}{pygformula}
\end{sphinxVerbatim}


\chapter{Get Started}
\label{\detokenize{Get Started:get-started}}\label{\detokenize{Get Started::doc}}

\section{Algorithm outline}
\label{\detokenize{Get Started:algorithm-outline}}
\sphinxAtStartPar
The parametric g\sphinxhyphen{}formula estimator of noniterative conditional expectation (NICE) requires
the specification of models for the joint density of the confounders, treatments, and outcomes over time.
The algorithm implementation contains three steps: (1) Parametric estimation, (2) Monte Carlo simulation
, and (3) Calculation of risk/mean under each intervention.
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Parametric estimation}: (a) estimate the conditional densities of each covariate given past covariate history
by fitting user\sphinxhyphen{}specified covariate models, (b) estimate the discrete hazard (for survival outcome) or mean
(for binary/continuous end of follow\sphinxhyphen{}up) of outcome conditional on past covariate history by fitting user\sphinxhyphen{}specified outcome model,
(c) if the event of interest is subject to competing events and competing events are not treated as censoring events, estimate the conditional probability of the competing event
conditional on past covariate history by fitting user\sphinxhyphen{}specified competing model.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Monte Carlo simulation}: (a) generate a new dataset which is usually larger than original dataset, for each covariate,
generate its simulated values at each time step using the estimated covariate model from step (1), (b) for the
covariates that accept intervention assignment, their values are assigned according to the user\sphinxhyphen{}specified intervention rule,
(c) obtain the discrete hazard / mean of the outcome based on the estimated outcome model from step (1),
(d) if the event of interest is subject to competing events and competing events are not treated as censoring events,
obtain the discrete hazard of the competing event based on the estimated competing model from step (1).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Calculation of risk/mean under each intervention}: for binary/continuous end of follow\sphinxhyphen{}up, the final estimate is the mean of
the eatimated outcome of all individuals in the new dataset computed from Step (2). For survival outcome,
the final estimate is obtained by calculating the mean of cumulative risks for all individuals using the discrete hazards computed from step (2).

\end{itemize}

\sphinxAtStartPar
Arguments:

\phantomsection\label{\detokenize{Get Started:module-pygformula.parametric_gformula}}\index{module@\spxentry{module}!pygformula.parametric\_gformula@\spxentry{pygformula.parametric\_gformula}}\index{pygformula.parametric\_gformula@\spxentry{pygformula.parametric\_gformula}!module@\spxentry{module}}

\begin{savenotes}\sphinxatlongtablestart\begin{longtable}[c]{\X{1}{2}\X{1}{2}}
\hline

\endfirsthead

\multicolumn{2}{c}%
{\makebox[0pt]{\sphinxtablecontinued{\tablename\ \thetable{} \textendash{} continued from previous page}}}\\
\hline

\endhead

\hline
\multicolumn{2}{r}{\makebox[0pt][r]{\sphinxtablecontinued{continues on next page}}}\\
\endfoot

\endlastfoot

\sphinxAtStartPar
{\hyperref[\detokenize{Get Started:pygformula.parametric_gformula.ParametricGformula}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{ParametricGformula}}}}}(obs\_data, id\_name, ...{[}, ...{]})
&
\sphinxAtStartPar
G\sphinxhyphen{}formula estimation under parametric models.
\\
\hline
\end{longtable}\sphinxatlongtableend\end{savenotes}
\index{ParametricGformula (class in pygformula.parametric\_gformula)@\spxentry{ParametricGformula}\spxextra{class in pygformula.parametric\_gformula}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Get Started:pygformula.parametric_gformula.ParametricGformula}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{  }}}\sphinxcode{\sphinxupquote{pygformula.parametric\_gformula.}}\sphinxbfcode{\sphinxupquote{ParametricGformula}}}{\emph{\DUrole{n}{obs\_data}}, \emph{\DUrole{n}{id\_name}}, \emph{\DUrole{n}{time\_name}}, \emph{\DUrole{n}{outcome\_name}}, \emph{\DUrole{n}{outcome\_model}}, \emph{\DUrole{n}{covnames}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{covtypes}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{covmodels}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{int\_descript}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{custom\_histvars}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{custom\_histories}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{covfits\_custom}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{covpredict\_custom}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{nsamples}\DUrole{o}{=}\DUrole{default_value}{0}}, \emph{\DUrole{n}{compevent\_name}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{compevent\_model}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{compevent\_cens}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{intcomp}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{censor\_name}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{censor\_model}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{model\_fits}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{boot\_diag}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{ipw\_cutoff\_quantile}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{ipw\_cutoff\_value}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{outcome\_type}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{trunc\_params}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{time\_thresholds}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{time\_points}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{n\_simul}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{baselags}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{visitprocess}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{restrictions}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{yrestrictions}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{compevent\_restrictions}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{basecovs}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{parallel}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{ncores}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{ref\_int}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{ci\_method}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{seed}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{save\_path}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{save\_results}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{o}{**}\DUrole{n}{interventions}}}{}
\sphinxAtStartPar
G\sphinxhyphen{}formula estimation under parametric models.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{obs\_data}} (\sphinxstyleliteralemphasis{\sphinxupquote{DataFrame}}) \textendash{} A data frame containing the observed data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{id\_name}} (\sphinxstyleliteralemphasis{\sphinxupquote{Str}}) \textendash{} A string specifying the name of the id variable in obs\_data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{time\_name}} (\sphinxstyleliteralemphasis{\sphinxupquote{Str}}) \textendash{} A string specifying the name of the time variable in obs\_data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{outcome\_name}} (\sphinxstyleliteralemphasis{\sphinxupquote{Str}}) \textendash{} A string specifying the name of the outcome variable in obs\_data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{outcome\_model}} (\sphinxstyleliteralemphasis{\sphinxupquote{Str}}) \textendash{} A string specifying the model statement for the outcome variable.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{covnames}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} A list of strings specifying the names of the time\sphinxhyphen{}varying covariates in obs\_data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{covtypes}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} A list of strings specifying the “type” of each time\sphinxhyphen{}varying covariate included in covnames.
The supported types: “binary”, “normal”, “categorical”, “bounded normal”, “zero\sphinxhyphen{}inflated normal”,
“truncated normal”, “absorbing”, “categorical time”, “square time” and “custom”. The list must be the same
length as covnames and in the same order.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{covmodels}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} A list of strings, where each string is the model statement of the time\sphinxhyphen{}varying covariate. The list
must be the same length as covnames and in the same order. If a model is not required for a certain covariate,
it should be set to ‘NA’ at that index.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{int\_descript}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} A list of strings, each of which describes a user\sphinxhyphen{}specified intervention.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{custom\_histvars}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} A list of strings, each of which specifies the names of the time\sphinxhyphen{}varying covariates with user\sphinxhyphen{}specified custom histories.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{custom\_histories}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} A list of function, each function is the user\sphinxhyphen{}specified custom history functions for covariates. The list
must be the same length as custom\_histvars and in the same order.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{covfits\_custom}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} A list, at the index where the covtype is set to “custom”, the element is a user\sphinxhyphen{}specified fit function,
otherwise it should be set to ‘NA’. The list must be the same length as covnames and in the same order.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{covpredict\_custom}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} A list, at the index where the covtype is set to “custom”, the element is a user\sphinxhyphen{}specified predict function,
otherwise it should be set to ‘NA’.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nsamples}} (\sphinxstyleliteralemphasis{\sphinxupquote{Int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is 0.}}) \textendash{} An integer specifying the number of bootstrap samples to generate.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{compevent\_name}} (\sphinxstyleliteralemphasis{\sphinxupquote{Str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} A string specifying the name of the competing event variable in obs\_data. Only applicable for survival outcomes.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{compevent\_model}} (\sphinxstyleliteralemphasis{\sphinxupquote{Str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} A string specifying the model statement for the competing event variable. Only applicable for survival outcomes.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{compevent\_cens}} (\sphinxstyleliteralemphasis{\sphinxupquote{Bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is False}}) \textendash{} A boolean value indicating whether to treat competing events as censoring events.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{intcomp}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} List of two numbers indicating a pair of interventions to be compared by a hazard ratio.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{censor\_name}} (\sphinxstyleliteralemphasis{\sphinxupquote{Str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} A string specifying the name of the censoring variable in obs\_data. Only applicable when using inverse
probability weights to estimate the natural course means / risk from the observed data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{censor\_model}} (\sphinxstyleliteralemphasis{\sphinxupquote{Str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} A string specifying the model statement for the censoring variable. Only applicable when using inverse
probability weights to estimate the natural course means / risk from the observed data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{model\_fits}} (\sphinxstyleliteralemphasis{\sphinxupquote{Bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is False}}) \textendash{} A boolean value indicating whether to return the fitted models.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{boot\_diag}} (\sphinxstyleliteralemphasis{\sphinxupquote{Bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is False}}) \textendash{} A boolean value indicating whether to return the parametric g\sphinxhyphen{}formula estimates as well as the coefficients,
standard errors, and variance\sphinxhyphen{}covariance matrices of the parameters of the fitted models in the bootstrap samples.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ipw\_cutoff\_quantile}} (\sphinxstyleliteralemphasis{\sphinxupquote{Float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} A percentile by which to truncate inverse probability weights.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ipw\_cutoff\_value}} (\sphinxstyleliteralemphasis{\sphinxupquote{Float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} A cutoff value by which to truncate inverse probability weights.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{outcome\_type}} (\sphinxstyleliteralemphasis{\sphinxupquote{Str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} A string specifying the “type” of outcome. The possible “types” are: “survival”, “continuous\_eof”, and “binary\_eof”.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{trunc\_params}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} A list, at the index where the covtype is set to “truncated normal”, the list contains two elements.
The first element specifies the truncated value and the second element specifies the truncated direction
(‘left’ or ‘right’). The values at remaining indexes are set to ‘NA’. The list must be the same length as
covnames and in the same order.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{time\_thresholds}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} A list of integers that splits the time points into different intervals. It is used to create the time variable
of “categorical time”.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{time\_points}} (\sphinxstyleliteralemphasis{\sphinxupquote{Int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} An integer indicating the number of time points to simulate. It is set equal to the maximum number of records
that obs\_data contains for any individual plus 1, if not specified by users.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{n\_simul}} (\sphinxstyleliteralemphasis{\sphinxupquote{Int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} An integer indicating the number of subjects for whom to simulate data. It is set equal to the number of
subjects in obs\_data, if not specified by users.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{baselags}} (\sphinxstyleliteralemphasis{\sphinxupquote{Bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is False}}) \textendash{} A boolean value specifying the convention used for lagi and lag\_cumavgi terms in the model statements when
pre\sphinxhyphen{}baseline times are not included in obs\_data and when the current time index, t, is such that t \textless{} i. If this
argument is set to False, the value of all lagi and lag\_cumavgi terms in this context are set to 0 (for
non\sphinxhyphen{}categorical covariates) or the reference level (for categorical covariates). If this argument is set to
True, the value of lagi and lag\_cumavgi terms are set to their values at time 0. The default is False.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{visitprocess}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} List of lists. Each inner list contains its first entry the covariate name of a visit process; its second entry
the name of a covariate whose modeling depends on the visit process; and its third entry the maximum number
of consecutive visits that can be missed before an individual is censored.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{restrictions}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} A list with lists, each inner list contains its first entry the covariate name of that its deterministic knowledge
is known; its second entry is a dictionary whose key is the conditions which should be True when the covariate
is modeled, the third entry is the value that is set to the covariate during simulation when the conditions
in the second entry are not True.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{yrestrictions}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} A list with lists, for each inner list, its first entry is a dictionary whose key is the conditions which
should be True when the outcome is modeled, the second entry is the value that is set to the outcome during
simulation when the conditions in the first entry are not True.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{compevent\_restrictions}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} A list with lists, for each inner list, its first entry is a dictionary whose key is the conditions which
should be True when the competing event is modeled, the second entry is the value that is set to the competing
event during simulation when the conditions in the first entry are not True. Only applicable for survival outcomes.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{basecovs}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} A vector of strings specifying the names of baseline covariates in obs\_data. These covariates are not
simulated using a model but keep the same value at all time points. These covariates should not be included
in covnames.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{parallel}} (\sphinxstyleliteralemphasis{\sphinxupquote{Bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is False}}) \textendash{} A boolean value indicating whether to parallelize simulations of different interventions to multiple cores.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ncores}} (\sphinxstyleliteralemphasis{\sphinxupquote{Int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} An integer indicating the number of cores used in parallelization. It is set to 1 if not specified by users.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ref\_int}} (\sphinxstyleliteralemphasis{\sphinxupquote{Int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} An integer indicating the intervention to be used as the reference for calculating the end\sphinxhyphen{}of\sphinxhyphen{}follow\sphinxhyphen{}up mean/risk
ratio and mean/risk difference. 0 denotes the natural course, while subsequent integers denote user\sphinxhyphen{}specified
interventions in the order that they are named in interventions. It is set to 0 if not specified by users.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ci\_method}} (\sphinxstyleliteralemphasis{\sphinxupquote{Str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} A string specifying the method for calculating the bootstrap 95\% confidence intervals, if applicable.
The options are “percentile” and “normal”. It is set to “percentile” if not specified by users.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{seed}} (\sphinxstyleliteralemphasis{\sphinxupquote{Int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} An integar indicating the starting seed for simulations and bootstrapping. It is set to 1234 if not specified by users.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{save\_path}} (\sphinxstyleliteralemphasis{\sphinxupquote{Path}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} A path to save all the returned results. A folder will be created automatically in the current working directory
if the save\_path is not specified by users.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{save\_results}} (\sphinxstyleliteralemphasis{\sphinxupquote{Bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is False}}) \textendash{} A boolean value indicating whether to save all the returned results to the save\_path.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{**interventions}} (\sphinxstyleliteralemphasis{\sphinxupquote{Dict}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default is None}}) \textendash{} A dictionary whose key is the treatment name in the intervention with the format Intervention\{id\}\_\{treatment\_name\},
value is a list that contains the intervention function, values required by the function, and a list of time
points in which the intervention is applied.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}


\sphinxAtStartPar
The above arguments are interface arguments that users can specify to perform causal effect estimation.
The following example shows a basic usage of the method.


\section{Example}
\label{\detokenize{Get Started:example}}
\sphinxAtStartPar
Here we go through an example of estimating the effect of two static interventions on risk of a failure event.
The observational dataset
\sphinxhref{https://github.com/CausalInference/pygformula/blob/master/datasets/example\_data\_basicdata\_nocomp.csv}{example\_data\_basicdata\_nocomp} consists of 13,170 observations on 2,500 individuals with a maximum of 7 follow\sphinxhyphen{}up
times. The dataset contains variables:
\begin{itemize}
\item {} 
\sphinxAtStartPar
id: Unique identifier for each individual.

\item {} 
\sphinxAtStartPar
t0: Time index.

\item {} 
\sphinxAtStartPar
L1: Binary time\sphinxhyphen{}varying covariate.

\item {} 
\sphinxAtStartPar
L2: Continuous time\sphinxhyphen{}varying covariate.

\item {} 
\sphinxAtStartPar
L3: Categorical baseline covariate.

\item {} 
\sphinxAtStartPar
A: Binary treatment variable.

\item {} 
\sphinxAtStartPar
Y: Outcome of interest; time\sphinxhyphen{}varying indicator of failure.

\end{itemize}

\sphinxAtStartPar
We are interested in the risk by end of follow\sphinxhyphen{}up under static interventions ‘‘Never treat’’ (assign 0 to the treatment at all follow\sphinxhyphen{}up times for all individuals)
and ‘‘Always treat’’ (assign 1 to the treatment at all follow\sphinxhyphen{}up times for all individuals).
\begin{itemize}
\item {} 
\sphinxAtStartPar
First, import g\sphinxhyphen{}formula method

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
Then, read the data (here is an example of loading simulated \sphinxhref{https://github.com/CausalInference/pygformula/blob/master/datasets}{data} in the package) as required DataFrame type

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}
\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
Specify the name of time variable, the name of individual identifier in the input data

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
Specify covariate names, covariate types, and corresponding model statements

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bounded normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1 \PYGZti{} lag1\PYGZus{}A + lag2\PYGZus{}A + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} lag1\PYGZus{}A + L1 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L1 + L2 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\sphinxAtStartPar
If there is baseline covariate (covariate with the repeated values at all time points) in the model
statement, specify it in the ‘‘basecovs’’ argument:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{basecovs} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
Specify the static interventions of interest

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{static}

\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Never treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Always treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
\PYG{n}{Intervention2\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
Specify the outcome name, outcome model statement, and the outcome type

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} L1 + L2 + L3 + A + lag1\PYGZus{}A + lag1\PYGZus{}L1 + lag1\PYGZus{}L2 + t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}type} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
Call the ‘‘ParametricGformula’’ method:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covparams}\PYG{o}{=}\PYG{n}{covparams}\PYG{p}{,} \PYG{n}{basecovs}\PYG{o}{=}\PYG{n}{basecovs}\PYG{p}{,}
    \PYG{n}{time\PYGZus{}points}\PYG{o}{=}\PYG{n}{time\PYGZus{}points}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{Intervention2\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}type} \PYG{o}{=} \PYG{n}{outcome\PYGZus{}type}\PYG{p}{)}

\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
Finally, get the output:

\noindent{\hspace*{\fill}\sphinxincludegraphics{{get_started_example}.png}\hspace*{\fill}}
\begin{itemize}
\item {} 
\sphinxAtStartPar
“Intervention”: the name of natural course intervention and user\sphinxhyphen{}specified interventions.

\item {} 
\sphinxAtStartPar
“NP\sphinxhyphen{}risk”: the nonparametric estimates of the natural course risk.

\item {} 
\sphinxAtStartPar
“g\sphinxhyphen{}formula risk”: the parametric g\sphinxhyphen{}formula estimates of each interventions.

\item {} 
\sphinxAtStartPar
“Risk Ratio (RR)”: the risk ratio value between each intervention and reference intervention.

\item {} 
\sphinxAtStartPar
“Risk Difference (RD)”: the risk difference value between each intervention and reference intervention.

\end{itemize}

\end{itemize}

\sphinxAtStartPar
In the output table, it shows the g\sphinxhyphen{}formula risk results under specified interventions, as well as the natural course
intervention (which means no intervention on the treatment variable). It also reports the nonparametric risk result of natural course,
which can be used to assess model misspecification of paramtric g\sphinxhyphen{}formula. Meanwhile, the risk ratio and risk difference
between the specific intervention and reference intervention (which is set to natural course intervention by default) are calculated.

\sphinxAtStartPar
Users can also get the estimate standard errors and 95\% confidence intervals of the g\sphinxhyphen{}formula estimate by specifying the ‘‘nsamples’’ argument.
For example, specifying ‘‘nsamples’’ as 20 with parallel processing using 8 cores:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{Intervention2\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,}
    \PYG{n}{basecovs}\PYG{o}{=}\PYG{n}{basecovs}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}type}\PYG{p}{,}
    \PYG{n}{nsamples}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{parallel}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{ncores}\PYG{o}{=}\PYG{l+m+mi}{8}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
The package will return following results:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics[width=8.5in,height=2in]{{get_started_example_bootstrap}.jpg}\hspace*{\fill}}
\end{quote}

\sphinxAtStartPar
The result table contains 95\% lower bound and upper bound for the risk, risk difference and risk ratio for all interventions.

\sphinxAtStartPar
The pygformula also provides plots for risk curves of interventions, which can be called by:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{g}\PYG{o}{.}\PYG{n}{plot\PYGZus{}interventions}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
It will return the g\sphinxhyphen{}formula risk (with 95\% confidence intervals if using bootstrap samples) at all follow\sphinxhyphen{}up times under each intervention:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics[width=5in,height=4in]{{get_started_example_intervention_curve}.jpg}\hspace*{\fill}}
\end{quote}

\sphinxAtStartPar
User can also get the plots of parametric and nonparametric estimates of
the risks and covariate means under natural course by:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{g}\PYG{o}{.}\PYG{n}{plot\PYGZus{}natural\PYGZus{}course}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{get_started_example_all}.jpg}\hspace*{\fill}}
\end{quote}

\sphinxAtStartPar
\sphinxstylestrong{Running example} \sphinxhref{https://github.com/CausalInference/pygformula/blob/main/running\_examples/get\_started\_example.py}{{[}code{]}}:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{static}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bounded normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1 \PYGZti{} lag1\PYGZus{}A + lag2\PYGZus{}A + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} lag1\PYGZus{}A + L1 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L1 + L2 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{basecovs} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} L1 + L2 + L3 + A + lag1\PYGZus{}A + lag1\PYGZus{}L1 + lag1\PYGZus{}L2 + t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}type} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Never treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Always treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,}
      \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,}
      \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
      \PYG{n}{Intervention2\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
      \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,}
      \PYG{n}{basecovs}\PYG{o}{=}\PYG{n}{basecovs}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,}
      \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}type}\PYG{p}{,}
      \PYG{n}{nsamples}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{parallel}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{ncores}\PYG{o}{=}\PYG{l+m+mi}{8}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{plot\PYGZus{}natural\PYGZus{}course}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{plot\PYGZus{}interventions}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}


\chapter{Specifications}
\label{\detokenize{Specifications/index:specifications}}\label{\detokenize{Specifications/index::doc}}
\sphinxAtStartPar
The ‘‘Specifications’’ section gives detailed instructions about how to specify the required or optional
arguments in different modules of pygformula to construct a specific analysis. To use the g\sphinxhyphen{}formula method in the package,
the first step is to make sure that the input data meets the requirement of
{\hyperref[\detokenize{Specifications/Input data::doc}]{\sphinxcrossref{\DUrole{doc}{Input data}}}}.
Then, users need to specify their parametric covariate model (see {\hyperref[\detokenize{Specifications/Covariate model::doc}]{\sphinxcrossref{\DUrole{doc}{Covariate model}}}}),
parametric outcome model (see {\hyperref[\detokenize{Specifications/Outcome model::doc}]{\sphinxcrossref{\DUrole{doc}{Outcome model}}}})
, as well as the intervention of interest (see {\hyperref[\detokenize{Specifications/Intervention::doc}]{\sphinxcrossref{\DUrole{doc}{Intervention}}}}).
Once these required modules are well\sphinxhyphen{}defined, the g\sphinxhyphen{}formula in pygformula can be called and output the results of the method.

\sphinxAtStartPar
Additionally, if there is censoring event, users need to specify corresponding arguments of the censoring event in
{\hyperref[\detokenize{Specifications/Censoring event::doc}]{\sphinxcrossref{\DUrole{doc}{Censoring event}}}}.
If there is competing event, users need to specify corresponding arguments of the competing event in
{\hyperref[\detokenize{Specifications/Competing event::doc}]{\sphinxcrossref{\DUrole{doc}{Competing event}}}}.
The package also provides option for calculating the hazard ratio of any two interventions of interest in
{\hyperref[\detokenize{Specifications/Hazard ratio::doc}]{\sphinxcrossref{\DUrole{doc}{Hazard ratio}}}}.
If the data structure contains visit process, users can also perform g\sphinxhyphen{}formula analysis for this setting in
{\hyperref[\detokenize{Specifications/Visit process::doc}]{\sphinxcrossref{\DUrole{doc}{Visit process}}}}.
If there is deterministic knowledge about the relationship between the variables, it can be incorporated into the estimation
of g\sphinxhyphen{}formula by applying restrictions ( see {\hyperref[\detokenize{Specifications/Deterministic knowledge::doc}]{\sphinxcrossref{\DUrole{doc}{Deterministic knowledge}}}}).

\sphinxAtStartPar
The capabilities implemented in the pygformula are basically the same as gfoRmula \sphinxstepexplicit %
\begin{footnote}[1]\phantomsection\label{\thesphinxscope.1}%
\sphinxAtStartFootnote
McGrath S, Lin V, Zhang Z, Petito LC, Logan RW, Hernán MA, Young JG. gfoRmula: An R Package for Estimating the Effects of Sustained Treatment Strategies via the Parametric g\sphinxhyphen{}formula. Patterns (N Y). 2020;1(3):100008. \sphinxhref{https://github.com/CausalInference/gfoRmula}{gfoRmula}.
%
\end{footnote} and GFORMULA SAS macro \sphinxstepexplicit %
\begin{footnote}[2]\phantomsection\label{\thesphinxscope.2}%
\sphinxAtStartFootnote
Roger W. Logan, Jessica G. Young, Sarah Taubman, Yu\sphinxhyphen{}Han Chiu, Sara Lodi, Sally Picciotto, Goodarz Danaei, Miguel A. Hernán. \sphinxhref{https://github.com/CausalInference/GFORMULA-SAS}{GFORMULA SAS}.
%
\end{footnote}.

\sphinxAtStartPar
\sphinxstylestrong{Contents}:


\section{Input data}
\label{\detokenize{Specifications/Input data:input-data}}\label{\detokenize{Specifications/Input data:id1}}\label{\detokenize{Specifications/Input data::doc}}
\sphinxAtStartPar
The input dataset is specified by the ‘‘obs\_data’’ argument which should contain: ‘‘id\_name’’ specifying
the individual identifier, ‘‘time\_name’’ specifying the time index, ‘‘covnames’’ specifying the names of covariate variables,
‘‘outcome\_name’’ specifying the name of the outcome of interest, ‘‘compevent\_name’’ indicating the competing
event status (if present), ‘‘censoring\_name’’ indicating the censoring event status (if present).

\sphinxAtStartPar
\sphinxstylestrong{The related arguments}:


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Arguments
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
\\
\hline
\sphinxAtStartPar
obs\_data
&
\sphinxAtStartPar
(Required) A data table (should be pandas.DataFrame type) containing the observed data.
\\
\hline
\sphinxAtStartPar
id\_name
&
\sphinxAtStartPar
(Required) A string specifying the name of the id variable in obs\_data.
\\
\hline
\sphinxAtStartPar
time\_name
&
\sphinxAtStartPar
(Required) A string specifying the name of the time variable in obs\_data.
\\
\hline
\sphinxAtStartPar
outcome\_name
&
\sphinxAtStartPar
(Required) A string specifying the name of the outcome variable in obs\_data.
\\
\hline
\sphinxAtStartPar
covnames
&
\sphinxAtStartPar
(Optional) A list of strings specifying the names of the time\sphinxhyphen{}varying covariates in obs\_data. If not specified, no confounders are adjusted.
\\
\hline
\sphinxAtStartPar
compevent\_name
&
\sphinxAtStartPar
(Optional) A string specifying the name of the competing event variable in obs\_data. Only applicable for survival outcomes.
\\
\hline
\sphinxAtStartPar
censor\_name
&
\sphinxAtStartPar
(Optional) A string specifying the name of the censoring variable in obs\_data. Only applicable for survival outcomes.
\\
\hline
\sphinxAtStartPar
time\_points
&
\sphinxAtStartPar
(Optional) Number of time points to simulate. By default, this argument is set equal to the maximum
number of records that obs\_data contains for any individual plus 1.
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
The input data should contain one record for each follow\sphinxhyphen{}up time k for each subject (identified by the individual identifier).
The time index k for each subject should increment by 1 for each subsequent interval (the starting index is 0 in the following
examples).
The record at each line in the data corresponds to an interval k, which contains the
covariate measurements at interval k and the outcome measurement at interval k+1.

\sphinxAtStartPar
Here is an example of input data structure for one subject which contains 7 records on
the measurements of three time\sphinxhyphen{}varying covariates ‘‘L1’’, ‘‘L2’’, ‘‘A’’,
one baseline covariate ‘‘L3’’ and the outcome ‘‘Y’’. See \sphinxhref{https://github.com/CausalInference/pygformula/blob/master/datasets/example\_data\_basicdata\_nocomp.csv}{“example\_data\_basicdata\_nocomp”} for complete example data.
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics[width=5.2in,height=1.8in]{{data_example}.png}\hspace*{\fill}}
\end{quote}

\sphinxAtStartPar
\sphinxstylestrong{Censoring events.} When there are censoring events in the data, there should be a variable in the input data set that is an
indicator of censoring in the time between covariate measurements in interval k and interval k+1, where
1 indicates the subject is censored (C\_k+1 = 1) and 0 indicates the subject is not censored (C\_k+1 = 0).
Subjects have no more records after they are censored.

\sphinxAtStartPar
For survival outcome, the outcome Y\_k+1 on the line where individual is censored (C\_k+1 = 1) can be coded NA or 0.
This choice will make no difference to estimates in the algorithm when intervals are made small enough
such that there are no failures in intervals where there are censoring events. It depends on
whether to count such subjects in the time k risk set or not \sphinxstepexplicit %
\begin{footnote}[1]\phantomsection\label{\thesphinxscope.1}%
\sphinxAtStartFootnote
McGrath S, Lin V, Zhang Z, Petito LC, Logan RW, Hernán MA, Young JG. gfoRmula: An R Package for Estimating the Effects of Sustained Treatment Strategies via the Parametric g\sphinxhyphen{}formula. Patterns (N Y). 2020;1(3):100008. \sphinxhref{https://github.com/CausalInference/gfoRmula}{gfoRmula}.
%
\end{footnote} \sphinxstepexplicit %
\begin{footnote}[2]\phantomsection\label{\thesphinxscope.2}%
\sphinxAtStartFootnote
Roger W. Logan, Jessica G. Young, Sarah Taubman, Yu\sphinxhyphen{}Han Chiu, Sara Lodi, Sally Picciotto, Goodarz Danaei, Miguel A. Hernán. \sphinxhref{https://github.com/CausalInference/GFORMULA-SAS}{GFORMULA SAS}.
%
\end{footnote}. For fixed binary/continuous end of follow\sphinxhyphen{}up, the
outcome Y\_k+1 should be coded NA.

\sphinxAtStartPar
Here is an example of input data structure with a censoring event (identified by ‘‘C’’). The subject contains 8 records on the measurements of
two time\sphinxhyphen{}varying covariates ‘‘L’’, ‘‘A’’, the outcome ‘‘Y’’ and is censored at time index k+1=8. See \sphinxhref{https://github.com/CausalInference/pygformula/blob/master/datasets/example\_data\_censor.csv}{“example\_data\_censor”} for complete example data.
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics[width=4.5in,height=2in]{{data_example_censor}.png}\hspace*{\fill}}
\end{quote}

\sphinxAtStartPar
\sphinxstylestrong{Competing events.} When there are competing events in the data, if the user chooses to treat competing
events as censoring events, the data should be structured as censoring case above. If competing events
are not treated as censoring events, there should be a variable in the input data set that is an
indicator of competing event between interval k and k+1 covariate measurements, where
1 indicates there is a competing event for the subject (D\_k+1 = 1) and 0 indicates no competing event (D\_k+1 = 0).
If D\_k+1 = 1 on a record line k for a given subject, that subject will only have k+1 lines
in the follow\sphinxhyphen{}up data with follow\sphinxhyphen{}up time k on the last line, and on that line, Y\_k+1 should be coded NA.
Note that the competing case is only applicable for survival outcome.

\sphinxAtStartPar
Here is an example of input data structure with a competing event (identified by ‘‘D’’). The subject contains 7 records on
three time\sphinxhyphen{}varying covariates ‘‘L1’’, ‘‘L2’’, ‘‘A’’, one baseline covariate ‘‘L3’’ and the outcome ‘‘Y’’.
The subject experiences a competing event after measurement of interval k=6 covariates. See \sphinxhref{https://github.com/CausalInference/pygformula/blob/master/datasets/example\_data\_basicdata.csv}{“example\_data\_basicdata”} for complete example data.
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics[width=6in,height=1.8in]{{data_example_competing}.png}\hspace*{\fill}}
\end{quote}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Note that the ‘‘time\_points’’ argument specifies the desired end of follow\sphinxhyphen{}up (a
follow\sphinxhyphen{}up interval k that is no more than the maximum number of records for an individual in the dataset) , and is applicable for survival outcome.

\end{itemize}


\section{Intervention}
\label{\detokenize{Specifications/Intervention:intervention}}\label{\detokenize{Specifications/Intervention:id1}}\label{\detokenize{Specifications/Intervention::doc}}
\sphinxAtStartPar
The package supports natural course intervention, static and dynamic interventions, as well as
threshold interventions \sphinxstepexplicit %
\begin{footnote}[1]\phantomsection\label{\thesphinxscope.1}%
\sphinxAtStartFootnote
Taubman SL, Robins JM, Mittleman MA, Hernán MA. Intervening on risk factors for coronary heart disease: an
application of the parametric g\sphinxhyphen{}formula. Int J Epidemiol 2009; 38(6):1599\sphinxhyphen{}611.
%
\end{footnote} \sphinxstepexplicit %
\begin{footnote}[2]\phantomsection\label{\thesphinxscope.2}%
\sphinxAtStartFootnote
Young JG, Hernán MA, Robins JM. Identification, estimation and approximation of risk under interventions that
depend on the natural value of treatment using observational data. Epidemiologic Methods 2014; 3(1):1\sphinxhyphen{}19.
%
\end{footnote} . It provides pre\sphinxhyphen{}coded intervention functions and options for users
to define other custom interventions that are beyond the interventions
provided.
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Natural course}: no intervention on any treatment variables.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Static intervention}:  intervention wherein the rule for assigning treatment at each time point does not depend on past covariates.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Dynamic intervention}: intervention wherein the rule for assigning treatment depends on past covariates.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Threshold intervention}: intervention wherein the rule for assigning treatment at each time point depends on the natural value of treatment at the time point.

\end{itemize}

\sphinxAtStartPar
The following are the arguments for specifying the intervention of interest. If not specified, the package will
return the result without intervention, i.e., natural course result. This section introduces how to
specify different types of intervention with these arguments.


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Arguments
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
\\
\hline
\sphinxAtStartPar
int\_descript
&
\sphinxAtStartPar
(Required) A list of strings, each of which describes a user\sphinxhyphen{}specified intervention.
\\
\hline
\sphinxAtStartPar
interventions
&
\sphinxAtStartPar
(Required) A dictionary whose key is the treatment name in the intervention with the format Intervention\{id\}\_\{treatment\_name\},
value is a list that contains the intervention function, values required by the function, and a list of time
points in which the intervention is applied.
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
The package uses keyword arguments to implement the intervention and allows any number of interventions.
When users specify each intervention, they should specify the intervention id (means the id\sphinxhyphen{}th intervention in all interventions,
and the id should start from 1) and treatment name in the argument name.

\sphinxAtStartPar
For static interventions, the value of the argument name is a list where the first element is the static intervention function, the second element
is the intervened values, the third element is a list specifying the time points to apply the intervention
(if not specified, the default is intervening on all time points);

\sphinxAtStartPar
An example of intervening on ‘‘A’’ in the first three time points with ‘‘Never treat’’ intervention:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{]}
\end{sphinxVerbatim}

\sphinxAtStartPar
For dynamic interventions, the value of the argument name is a list where the first element is the dynamic intervention function, the second element
is the intervened values, the second element is a list specifying the time points to apply the intervention.

\sphinxAtStartPar
An example of intervening on ‘‘A’’ in the first three time points with a dynamic intervention:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{dynamic}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{]}
\end{sphinxVerbatim}

\sphinxAtStartPar
For threshold interventions, the value of the argument name is a list where the first element is the threshold intervention function, the second element
is the threshold values, the third element is a list specifying the time points to apply the intervention.

\sphinxAtStartPar
An example of intervening on ‘‘A’’ in the first three time points with threshold intervention:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{threshold}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{n+nb}{float}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{inf}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{]}
\end{sphinxVerbatim}

\sphinxAtStartPar
If users want to specify multiple interventions, they should use different id for different interventions.

\sphinxAtStartPar
An example of intervening on ‘‘A’’ with different interventions:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}
\PYG{n}{Intervention2\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{dynamic}\PYG{p}{]}
\PYG{n}{Intervention3\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{threshold}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{n+nb}{float}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{inf}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{]}\PYG{p}{]}
\end{sphinxVerbatim}

\sphinxAtStartPar
If users want to specify joint intervention where there are multiple treatment variables,
they should specify different treatment name with the same intervention id.

\sphinxAtStartPar
An example of intervening on ‘‘A1’’ and ‘‘A2’’ within a static intervention:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Intervention1\PYGZus{}A1} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}
\PYG{n}{Intervention1\PYGZus{}A2} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}
\end{sphinxVerbatim}


\subsection{Natural course intervention}
\label{\detokenize{Specifications/Intervention:natural-course-intervention}}
\sphinxAtStartPar
If no intervention is specified, the package will return the result of natural course, containing
parametric and nonparametric natural course risk/mean outcome of g\sphinxhyphen{}formula. Users may assess model misspecification in
the parametric g\sphinxhyphen{}formula by comparing the two estimates \sphinxstepexplicit %
\begin{footnote}[3]\phantomsection\label{\thesphinxscope.3}%
\sphinxAtStartFootnote
Yu\sphinxhyphen{}Han Chiu, Lan Wen, Sean McGrath, Roger Logan, Issa J Dahabreh, Miguel A Hernán, Evaluating Model Specification
When Using the Parametric G\sphinxhyphen{}Formula in the Presence of Censoring, American Journal of Epidemiology, Volume 192, Issue 11, November 2023, Pages 1887\textendash{}1895
%
\end{footnote}.

\sphinxAtStartPar
\sphinxstylestrong{Running example} \sphinxhref{https://github.com/CausalInference/pygformula/blob/main/running\_examples/test\_natural\_course.py}{{[}code{]}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bounded normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1 \PYGZti{} lag1\PYGZus{}A + lag2\PYGZus{}A + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
           \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} lag1\PYGZus{}A + L1 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
           \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L1 + L2 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{basecovs} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} L1 + L2 + L3 + A + lag1\PYGZus{}A + lag1\PYGZus{}L1 + lag1\PYGZus{}L2 + t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}type} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,} \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,}
    \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,} \PYG{n}{basecovs}\PYG{o}{=}\PYG{n}{basecovs}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}type}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{natural_course_output}.png}\hspace*{\fill}}
\end{quote}


\subsection{Static interventions}
\label{\detokenize{Specifications/Intervention:static-interventions}}
\sphinxAtStartPar
The package has pre\sphinxhyphen{}coded static intervention.

\phantomsection\label{\detokenize{Specifications/Intervention:module-pygformula.parametric_gformula.interventions}}\index{module@\spxentry{module}!pygformula.parametric\_gformula.interventions@\spxentry{pygformula.parametric\_gformula.interventions}}\index{pygformula.parametric\_gformula.interventions@\spxentry{pygformula.parametric\_gformula.interventions}!module@\spxentry{module}}

\begin{savenotes}\sphinxatlongtablestart\begin{longtable}[c]{\X{1}{2}\X{1}{2}}
\hline

\endfirsthead

\multicolumn{2}{c}%
{\makebox[0pt]{\sphinxtablecontinued{\tablename\ \thetable{} \textendash{} continued from previous page}}}\\
\hline

\endhead

\hline
\multicolumn{2}{r}{\makebox[0pt][r]{\sphinxtablecontinued{continues on next page}}}\\
\endfoot

\endlastfoot

\sphinxAtStartPar
{\hyperref[\detokenize{Specifications/Intervention:pygformula.parametric_gformula.interventions.static}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{static}}}}}(new\_df, pool, int\_var, int\_values, ...)
&
\sphinxAtStartPar
This is an internal function to perform static intervention.
\\
\hline
\end{longtable}\sphinxatlongtableend\end{savenotes}
\index{static() (in module pygformula.parametric\_gformula.interventions)@\spxentry{static()}\spxextra{in module pygformula.parametric\_gformula.interventions}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Specifications/Intervention:pygformula.parametric_gformula.interventions.static}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pygformula.parametric\_gformula.interventions.}}\sphinxbfcode{\sphinxupquote{static}}}{\emph{\DUrole{n}{new\_df}}, \emph{\DUrole{n}{pool}}, \emph{\DUrole{n}{int\_var}}, \emph{\DUrole{n}{int\_values}}, \emph{\DUrole{n}{time\_name}}, \emph{\DUrole{n}{t}}}{}
\sphinxAtStartPar
This is an internal function to perform static intervention.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{new\_df}} (\sphinxstyleliteralemphasis{\sphinxupquote{DataFrame}}) \textendash{} A DataFrame that contains data frame at time t.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{pool}} (\sphinxstyleliteralemphasis{\sphinxupquote{DataFrame}}) \textendash{} A DataFrame that contains data frame up to time t.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{int\_var}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}) \textendash{} A list contains strings of treatment names to be intervened in a particular intervention.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{int\_values}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}) \textendash{} A list contains the value needed when performing a particular intervention function.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{time\_name}} (\sphinxstyleliteralemphasis{\sphinxupquote{Str}}) \textendash{} A string specifying the name of the time variable in obs\_data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{t}} (\sphinxstyleliteralemphasis{\sphinxupquote{Int}}) \textendash{} An integer indicating the current time index to be intervened.

\end{itemize}

\item[{Return type}] \leavevmode
\sphinxAtStartPar
Nothing is returned, the new\_df is changed under a particular intervention.

\end{description}\end{quote}

\end{fulllineitems}


\sphinxAtStartPar
which can be called by:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{static}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
When specifying the static intervention for one treatment,
the treatment value at each time step k will be replaced by the kth value in the list of intervened values.

\sphinxAtStartPar
\sphinxstylestrong{Running example of static intervention on one treatment variable} \sphinxhref{https://github.com/CausalInference/pygformula/blob/main/running\_examples/test\_static\_one\_treatment.py}{{[}code{]}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{static}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bounded normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1 \PYGZti{} lag1\PYGZus{}A + lag2\PYGZus{}A + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} lag1\PYGZus{}A + L1 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L1 + L2 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{basecovs} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Always treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{interventions} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{intvars} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{int\PYGZus{}times} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{]}

\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} L1 + L2 + L3 + A + lag1\PYGZus{}A + lag1\PYGZus{}L1 + lag1\PYGZus{}L2 + t0}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,} \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,}
    \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,} \PYG{n}{basecovs}\PYG{o}{=}\PYG{n}{basecovs}\PYG{p}{,} \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{static_example_one_treatment_output}.png}\hspace*{\fill}}
\end{quote}

\sphinxAtStartPar
\sphinxstylestrong{Running example of a static intervention on multiple treatment variables} \sphinxhref{https://github.com/CausalInference/pygformula/blob/main/running\_examples/test\_static\_multiple\_treatments.py}{{[}code{]}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{static}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}multiple\PYGZus{}treatments\PYGZus{}data}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}multiple\PYGZus{}treatments\PYGZus{}data}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bounded normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1 \PYGZti{} lag1\PYGZus{}L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} lag1\PYGZus{}L1 + lag1\PYGZus{}L2 + lag1\PYGZus{}A2 + L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A1 \PYGZti{} lag1\PYGZus{}L1 + lag1\PYGZus{}L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A2 \PYGZti{} lag1\PYGZus{}A1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Always treat on A1 \PYGZam{} A2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{interventions} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{intvars} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{]}

\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} L1 + L2 + A1 + A2}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,} \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,}
    \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,} \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A1} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A2} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{static_example_two_treatments}.png}\hspace*{\fill}}
\end{quote}

\sphinxAtStartPar
\sphinxstylestrong{Running example of multiple static interventions} \sphinxhref{https://github.com/CausalInference/pygformula/blob/main/running\_examples/get\_started\_example.py}{{[}code{]}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{static}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bounded normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1 \PYGZti{} lag1\PYGZus{}A + lag2\PYGZus{}A + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} lag1\PYGZus{}A + L1 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L1 + L2 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{basecovs} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} L1 + L2 + L3 + A + lag1\PYGZus{}A + lag1\PYGZus{}L1 + lag1\PYGZus{}L2 + t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}type} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Never treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Always treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
  \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,} \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,}
  \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,} \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
  \PYG{n}{Intervention1\PYGZus{}A1} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
  \PYG{n}{Intervention1\PYGZus{}A2} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
  \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{static_multiple_interventions}.png}\hspace*{\fill}}
\end{quote}


\subsection{Dynamic interventions}
\label{\detokenize{Specifications/Intervention:dynamic-interventions}}
\sphinxAtStartPar
For dynamic intervention, users need to define a dynamic function which encodes the dynamic strategy for
one treatment variable and then pass it into the g\sphinxhyphen{}formula method by the intervention argument.

\sphinxAtStartPar
Example dynamic intervention: treatment is assgined (A = 1) for individuals where the covariate L2 is above a certain threshold 0.75.
Otherwise, the treatment is assigned 0.

\sphinxAtStartPar
\sphinxstylestrong{Sample syntax of a dynamic function example}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{dynamic\PYGZus{}intervention}\PYG{p}{(}\PYG{n}{new\PYGZus{}df}\PYG{p}{,} \PYG{n}{pool}\PYG{p}{,} \PYG{n}{intvar}\PYG{p}{,} \PYG{n}{int\PYGZus{}type}\PYG{p}{,} \PYG{n}{int\PYGZus{}values}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{p}{,} \PYG{n}{t}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{new\PYGZus{}df}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{n}{new\PYGZus{}df}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]} \PYG{o}{==} \PYG{n}{t}\PYG{p}{,} \PYG{n}{intvar}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{0}
    \PYG{n}{new\PYGZus{}df}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{n}{new\PYGZus{}df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZgt{}} \PYG{l+m+mf}{0.75}\PYG{p}{,} \PYG{n}{intvar}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{1}

\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Dynamic intervention}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{dynamic\PYGZus{}intervention}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
                      \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{dynamic\PYGZus{}intervention}\PYG{p}{]}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
The dynamic intervention function should contain the following input parameters (these parameters are not all need to be specified in the function).
The function should modify the data table ‘‘new\_df’’ in place, no output is returned.
\begin{itemize}
\item {} 
\sphinxAtStartPar
new\_df: data table of the simulated data at current time t.

\item {} 
\sphinxAtStartPar
pool: data table of the simulated data up to current time t.

\item {} 
\sphinxAtStartPar
int\_var: the name of treatment variable to be intervened.

\item {} 
\sphinxAtStartPar
time\_name: the name of time variable.

\item {} 
\sphinxAtStartPar
t: current time index.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Running example} \sphinxhref{https://github.com/CausalInference/pygformula/blob/main/running\_examples/test\_dynamic\_intervention.py}{{[}code{]}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{static}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bounded normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1 \PYGZti{} lag1\PYGZus{}A + lag2\PYGZus{}A + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} lag1\PYGZus{}A + L1 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L1 + L2 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{basecovs} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}

\PYG{k}{def} \PYG{n+nf}{dynamic\PYGZus{}intervention}\PYG{p}{(}\PYG{n}{new\PYGZus{}df}\PYG{p}{,} \PYG{n}{pool}\PYG{p}{,} \PYG{n}{int\PYGZus{}var}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{p}{,} \PYG{n}{t}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{new\PYGZus{}df}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{n}{new\PYGZus{}df}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]} \PYG{o}{==} \PYG{n}{t}\PYG{p}{,} \PYG{n}{int\PYGZus{}var}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{0}
    \PYG{n}{new\PYGZus{}df}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{n}{new\PYGZus{}df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{\PYGZgt{}} \PYG{l+m+mf}{0.75}\PYG{p}{,} \PYG{n}{int\PYGZus{}var}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{1}

\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Dynamic intervention}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}


\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} L1 + L2 + L3 + A + lag1\PYGZus{}A + lag1\PYGZus{}L1 + lag1\PYGZus{}L2 + t0}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,} \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,}
    \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,} \PYG{n}{basecovs}\PYG{o}{=}\PYG{n}{basecovs}\PYG{p}{,} \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{dynamic\PYGZus{}intervention}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{dynamic_example_output}.png}\hspace*{\fill}}
\end{quote}

\sphinxAtStartPar
The package also provides two pre\sphinxhyphen{}coded dynamic interventions with grace period: natural grace period intervention
and uniform grace period intervention. When specifying intervention with grace period, the list of the intervention
argument should contain the grace period intervention function in the first element, a two\sphinxhyphen{}element list with the
duration of grace period and conditions in the second element. (If users want to intervene on particular
time points, the third element should be specified.)

\sphinxAtStartPar
\sphinxstylestrong{Natural grace period intervention}: once a conditional covariate meets a threshold level, the treatment
is initiated within a duration of the grace period. During the grace period, the treatment takes its natural value.

\phantomsection\label{\detokenize{Specifications/Intervention:module-0}}\index{module@\spxentry{module}!pygformula.parametric\_gformula.interventions@\spxentry{pygformula.parametric\_gformula.interventions}}\index{pygformula.parametric\_gformula.interventions@\spxentry{pygformula.parametric\_gformula.interventions}!module@\spxentry{module}}

\begin{savenotes}\sphinxatlongtablestart\begin{longtable}[c]{\X{1}{2}\X{1}{2}}
\hline

\endfirsthead

\multicolumn{2}{c}%
{\makebox[0pt]{\sphinxtablecontinued{\tablename\ \thetable{} \textendash{} continued from previous page}}}\\
\hline

\endhead

\hline
\multicolumn{2}{r}{\makebox[0pt][r]{\sphinxtablecontinued{continues on next page}}}\\
\endfoot

\endlastfoot

\sphinxAtStartPar
{\hyperref[\detokenize{Specifications/Intervention:pygformula.parametric_gformula.interventions.natural_grace_period}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{natural\_grace\_period}}}}}(new\_df, pool, int\_var, ...)
&
\sphinxAtStartPar
This is a pre\sphinxhyphen{}coded function to perform a natural grace period intervention.
\\
\hline
\end{longtable}\sphinxatlongtableend\end{savenotes}
\index{natural\_grace\_period() (in module pygformula.parametric\_gformula.interventions)@\spxentry{natural\_grace\_period()}\spxextra{in module pygformula.parametric\_gformula.interventions}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Specifications/Intervention:pygformula.parametric_gformula.interventions.natural_grace_period}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pygformula.parametric\_gformula.interventions.}}\sphinxbfcode{\sphinxupquote{natural\_grace\_period}}}{\emph{\DUrole{n}{new\_df}}, \emph{\DUrole{n}{pool}}, \emph{\DUrole{n}{int\_var}}, \emph{\DUrole{n}{nperiod}}, \emph{\DUrole{n}{conditions}}, \emph{\DUrole{n}{time\_name}}, \emph{\DUrole{n}{t}}}{}
\sphinxAtStartPar
This is a pre\sphinxhyphen{}coded function to perform a natural grace period intervention. Once a conditional covariate
meets a threshold level, the treatment (int\_var) is initiated within m (nperiod) time intervals which is the duration
of the grace period. During grace period, the treatment takes its natural value.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{new\_df}} (\sphinxstyleliteralemphasis{\sphinxupquote{DataFrame}}) \textendash{} A DataFrame that contains data frame at time t.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{pool}} (\sphinxstyleliteralemphasis{\sphinxupquote{DataFrame}}) \textendash{} A DataFrame that contains data frame up to time t.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{int\_var}} (\sphinxstyleliteralemphasis{\sphinxupquote{Str}}) \textendash{} A string specifying the treatment variable to be intervened.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nperiod}} (\sphinxstyleliteralemphasis{\sphinxupquote{Int}}) \textendash{} An integar indicating the duration of the grace period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{conditions}} (\sphinxstyleliteralemphasis{\sphinxupquote{Dict}}) \textendash{} A dictionary that contains the covariate and its coditions for initiating the treatment.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{time\_name}} (\sphinxstyleliteralemphasis{\sphinxupquote{Str}}) \textendash{} A string specifying the name of the time variable in obs\_data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{t}} (\sphinxstyleliteralemphasis{\sphinxupquote{Int}}) \textendash{} An integer indicating the current time index to be intervened.

\end{itemize}

\item[{Return type}] \leavevmode
\sphinxAtStartPar
Nothing is returned, the new\_df is changed under a particular intervention.

\end{description}\end{quote}

\end{fulllineitems}


\sphinxAtStartPar
which can be called by:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{natural\PYGZus{}grace\PYGZus{}period}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Sample syntax of an example}:

\sphinxAtStartPar
When the covariate ‘‘L1’’ equals 1, start a treatment initiation in a grace period with duration 3. The ‘‘natural\_grace\_period’’
specifies the type of the grace period intervention, the two\sphinxhyphen{}element list specifies the duration of the grace period
in the first entry and the condition of the covariate in the second entry.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{natural\PYGZus{}grace\PYGZus{}period}

\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{natural grace period intervention}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{natural\PYGZus{}grace\PYGZus{}period}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{==} \PYG{l+m+mi}{1}\PYG{p}{\PYGZcb{}}\PYG{p}{]}\PYG{p}{]}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
An examle of grace period intervention where the treatment is initiated when multiple conditions are met:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{natural\PYGZus{}grace\PYGZus{}period}

\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{natural grace period intervention}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
            \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{natural\PYGZus{}grace\PYGZus{}period}\PYG{p}{,} \PYG{p}{[}\PYG{n}{natural\PYGZus{}grace\PYGZus{}period}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{==} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{\PYGZgt{}}\PYG{o}{=} \PYG{l+m+mi}{2}\PYG{p}{\PYGZcb{}}\PYG{p}{]}\PYG{p}{]}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Running example} \sphinxhref{https://github.com/CausalInference/pygformula/blob/main/running\_examples/test\_natural\_grace\_period.py}{{[}code{]}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{natural\PYGZus{}grace\PYGZus{}period}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bounded normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1 \PYGZti{} lag1\PYGZus{}A + lag2\PYGZus{}A + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} lag1\PYGZus{}A + L1 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L1 + L2 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{basecovs} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}

\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{natural grace period intervention}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}


\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} L1 + L2 + L3 + A + lag1\PYGZus{}A + lag1\PYGZus{}L1 + lag1\PYGZus{}L2 + t0}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,} \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,}
    \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,} \PYG{n}{basecovs}\PYG{o}{=}\PYG{n}{basecovs}\PYG{p}{,} \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{natural\PYGZus{}grace\PYGZus{}period}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{==} \PYG{l+m+mi}{1}\PYG{p}{\PYGZcb{}}\PYG{p}{]}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{natural_grace_period}.png}\hspace*{\fill}}
\end{quote}

\sphinxAtStartPar
\sphinxstylestrong{Uniform grace period intervention}  Once a conditional covariate meets a threshold level, the treatment
is initiated within a duration of the grace period. During grace period, treatment initiation is
randomly allocated with a uniform probability of starting treatment in each time interval of the grace period.

\phantomsection\label{\detokenize{Specifications/Intervention:module-1}}\index{module@\spxentry{module}!pygformula.parametric\_gformula.interventions@\spxentry{pygformula.parametric\_gformula.interventions}}\index{pygformula.parametric\_gformula.interventions@\spxentry{pygformula.parametric\_gformula.interventions}!module@\spxentry{module}}

\begin{savenotes}\sphinxatlongtablestart\begin{longtable}[c]{\X{1}{2}\X{1}{2}}
\hline

\endfirsthead

\multicolumn{2}{c}%
{\makebox[0pt]{\sphinxtablecontinued{\tablename\ \thetable{} \textendash{} continued from previous page}}}\\
\hline

\endhead

\hline
\multicolumn{2}{r}{\makebox[0pt][r]{\sphinxtablecontinued{continues on next page}}}\\
\endfoot

\endlastfoot

\sphinxAtStartPar
{\hyperref[\detokenize{Specifications/Intervention:pygformula.parametric_gformula.interventions.uniform_grace_period}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{uniform\_grace\_period}}}}}(new\_df, pool, int\_var, ...)
&
\sphinxAtStartPar
This is a pre\sphinxhyphen{}coded function to perform a uniform grace period intervention.
\\
\hline
\end{longtable}\sphinxatlongtableend\end{savenotes}
\index{uniform\_grace\_period() (in module pygformula.parametric\_gformula.interventions)@\spxentry{uniform\_grace\_period()}\spxextra{in module pygformula.parametric\_gformula.interventions}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Specifications/Intervention:pygformula.parametric_gformula.interventions.uniform_grace_period}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pygformula.parametric\_gformula.interventions.}}\sphinxbfcode{\sphinxupquote{uniform\_grace\_period}}}{\emph{\DUrole{n}{new\_df}}, \emph{\DUrole{n}{pool}}, \emph{\DUrole{n}{int\_var}}, \emph{\DUrole{n}{nperiod}}, \emph{\DUrole{n}{conditions}}, \emph{\DUrole{n}{time\_name}}, \emph{\DUrole{n}{t}}}{}
\sphinxAtStartPar
This is a pre\sphinxhyphen{}coded function to perform a uniform grace period intervention. Once a conditional covariate
meets a threshold level, the treatment (int\_var) is initiated within m (nperiod) time intervals which is the duration
of the grace period. During grace period, treatment initiation is randomly allocated with a uniform probability of
starting treatment in each time interval of the grace period.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{new\_df}} (\sphinxstyleliteralemphasis{\sphinxupquote{DataFrame}}) \textendash{} A DataFrame that contains data frame at time t.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{pool}} (\sphinxstyleliteralemphasis{\sphinxupquote{DataFrame}}) \textendash{} A DataFrame that contains data frame up to time t.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{int\_var}} (\sphinxstyleliteralemphasis{\sphinxupquote{Str}}) \textendash{} A string specifying the treatment variable to be intervened.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nperiod}} (\sphinxstyleliteralemphasis{\sphinxupquote{Int}}) \textendash{} An integar indicating the duration of the grace period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{conditions}} (\sphinxstyleliteralemphasis{\sphinxupquote{Dict}}) \textendash{} A dictionary that contains the covariate and its coditions for initiating the treatment.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{time\_name}} (\sphinxstyleliteralemphasis{\sphinxupquote{Str}}) \textendash{} A string specifying the name of the time variable in obs\_data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{t}} (\sphinxstyleliteralemphasis{\sphinxupquote{Int}}) \textendash{} An integer indicating the current time index to be intervened.

\end{itemize}

\item[{Return type}] \leavevmode
\sphinxAtStartPar
Nothing is returned, the new\_df is changed under a particular intervention.

\end{description}\end{quote}

\end{fulllineitems}


\sphinxAtStartPar
which can be called by:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{uniform\PYGZus{}grace\PYGZus{}period}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Sample syntax of an example}:

\sphinxAtStartPar
When the covariate ‘‘L1’’ equals 1, start a treatment initiation in a grace period with duration 3. The ‘‘uniform\_grace\_period’’
specifies the type of the grace period intervention, the two\sphinxhyphen{}element list specifies the duration of the grace period
in the first entry and the condition of the covariate in the second entry.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{uniform\PYGZus{}grace\PYGZus{}period}

\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{uniform grace period intervention}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{uniform\PYGZus{}grace\PYGZus{}period}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{==} \PYG{l+m+mi}{1}\PYG{p}{\PYGZcb{}}\PYG{p}{]}\PYG{p}{]}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Running example} \sphinxhref{https://github.com/CausalInference/pygformula/blob/main/running\_examples/test\_uniform\_grace\_period.py}{{[}code{]}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{uniform\PYGZus{}grace\PYGZus{}period}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bounded normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1 \PYGZti{} lag1\PYGZus{}A + lag2\PYGZus{}A + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} lag1\PYGZus{}A + L1 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L1 + L2 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{basecovs} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}

\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{uniform grace period intervention}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} L1 + L2 + L3 + A + lag1\PYGZus{}A + lag1\PYGZus{}L1 + lag1\PYGZus{}L2 + t0}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,} \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,}
    \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,} \PYG{n}{basecovs}\PYG{o}{=}\PYG{n}{basecovs}\PYG{p}{,} \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{uniform\PYGZus{}grace\PYGZus{}period}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{==} \PYG{l+m+mi}{1}\PYG{p}{\PYGZcb{}}\PYG{p}{]}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{uniform_grace_period}.png}\hspace*{\fill}}
\end{quote}


\subsection{Threshold interventions}
\label{\detokenize{Specifications/Intervention:threshold-interventions}}
\sphinxAtStartPar
The threshold interventions in the package implement interventions that depend on the natural value of treatment.
In a threshold intervention, if a subject’s natural value of treatment at time k is below/above a particular threshold
, then set treatment to this threshold value. Otherwise, do not intervene on this subject at k.
The natural value of treatment at time k is the value of treatment that would have been observed at
time k were the intervention discontinued right before k.

\sphinxAtStartPar
The package provides pre\sphinxhyphen{}coded threshold function.

\phantomsection\label{\detokenize{Specifications/Intervention:module-2}}\index{module@\spxentry{module}!pygformula.parametric\_gformula.interventions@\spxentry{pygformula.parametric\_gformula.interventions}}\index{pygformula.parametric\_gformula.interventions@\spxentry{pygformula.parametric\_gformula.interventions}!module@\spxentry{module}}

\begin{savenotes}\sphinxatlongtablestart\begin{longtable}[c]{\X{1}{2}\X{1}{2}}
\hline

\endfirsthead

\multicolumn{2}{c}%
{\makebox[0pt]{\sphinxtablecontinued{\tablename\ \thetable{} \textendash{} continued from previous page}}}\\
\hline

\endhead

\hline
\multicolumn{2}{r}{\makebox[0pt][r]{\sphinxtablecontinued{continues on next page}}}\\
\endfoot

\endlastfoot

\sphinxAtStartPar
{\hyperref[\detokenize{Specifications/Intervention:pygformula.parametric_gformula.interventions.threshold}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{threshold}}}}}(new\_df, pool, int\_var, ...)
&
\sphinxAtStartPar
This is an internal function to perform threshold intervention.
\\
\hline
\end{longtable}\sphinxatlongtableend\end{savenotes}
\index{threshold() (in module pygformula.parametric\_gformula.interventions)@\spxentry{threshold()}\spxextra{in module pygformula.parametric\_gformula.interventions}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Specifications/Intervention:pygformula.parametric_gformula.interventions.threshold}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pygformula.parametric\_gformula.interventions.}}\sphinxbfcode{\sphinxupquote{threshold}}}{\emph{\DUrole{n}{new\_df}}, \emph{\DUrole{n}{pool}}, \emph{\DUrole{n}{int\_var}}, \emph{\DUrole{n}{threshold\_values}}, \emph{\DUrole{n}{time\_name}}, \emph{\DUrole{n}{t}}}{}
\sphinxAtStartPar
This is an internal function to perform threshold intervention.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{new\_df}} (\sphinxstyleliteralemphasis{\sphinxupquote{DataFrame}}) \textendash{} A DataFrame that contains data frame at time t.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{pool}} (\sphinxstyleliteralemphasis{\sphinxupquote{DataFrame}}) \textendash{} A DataFrame that contains data frame up to time t.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{int\_var}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}) \textendash{} A list contains strings of treatment names to be intervened in a particular intervention.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{threshold\_values}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}) \textendash{} A list contains the threshold values needed when performing a threshold intervention function.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{time\_name}} (\sphinxstyleliteralemphasis{\sphinxupquote{Str}}) \textendash{} A string specifying the name of the time variable in obs\_data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{t}} (\sphinxstyleliteralemphasis{\sphinxupquote{Int}}) \textendash{} An integer indicating the current time index to be intervened.

\end{itemize}

\item[{Return type}] \leavevmode
\sphinxAtStartPar
Nothing is returned, the new\_df is changed under a particular intervention.

\end{description}\end{quote}

\end{fulllineitems}


\sphinxAtStartPar
which can be called by

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{threshold}
\end{sphinxVerbatim}

\sphinxAtStartPar
Users should specify a two\sphinxhyphen{}element list (containing minimum and maximum values) of threshold values after the threshold function
in the argument.

\sphinxAtStartPar
Example threshold intervention: if the subject’s natural value of treatment L2 falls outside the interval {[}0.5, inf{]},
set the treatment the threshold value.

\sphinxAtStartPar
\sphinxstylestrong{Sample syntax of example threshold intervention}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Threshold intervention}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{threshold}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{n+nb}{float}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{inf}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{]}\PYG{p}{]}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Running example} \sphinxhref{https://github.com/CausalInference/pygformula/blob/main/running\_examples/test\_threshold\_intervention.py}{{[}code{]}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{threshold}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}threshold\PYGZus{}data}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}threshold\PYGZus{}data}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bounded normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1 \PYGZti{} lag1\PYGZus{}L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} lag1\PYGZus{}L1 + lag1\PYGZus{}L2 + L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} L1 + L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}

\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Threshold intervention}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} L1 + L2 + A}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,} \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,}
    \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,} \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{threshold}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{n+nb}{float}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{inf}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{]}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{threshold_example_output}.png}\hspace*{\fill}}
\end{quote}


\section{Covariate model}
\label{\detokenize{Specifications/Covariate model:covariate-model}}\label{\detokenize{Specifications/Covariate model:id1}}\label{\detokenize{Specifications/Covariate model::doc}}
\sphinxAtStartPar
To model the joint densities of covariates in g\sphinxhyphen{}formula, the conditional densities of each covariate given past covariate history
are estimated. Users can specify the covariate histories by the pre\sphinxhyphen{}coded functions of histories or custom histories.
The package provides options of modeling different covariate distributions
, which contains ‘‘binary’’, ‘‘normal’’, ‘‘categorical’’, ‘‘bounded normal’’, ‘‘zero\sphinxhyphen{}inflated normal’’, ‘‘truncated normal’’, ‘‘absorbing’’, ‘‘categorical time’’
and ‘‘square time’’.
Once the covariate model and covariate distribution are specified, the pygformula will fit a
pooled (over time) parametric model for each covariate. The custom covariate type is also allowed if users have their own
covariate distribution, which should be set to “custom” in corresponding covariate types.


\subsection{Functions of covariate histories}
\label{\detokenize{Specifications/Covariate model:functions-of-covariate-histories}}

\subsubsection{Pre\sphinxhyphen{}coded histories}
\label{\detokenize{Specifications/Covariate model:pre-coded-histories}}
\sphinxAtStartPar
The package provides three pre\sphinxhyphen{}coded functions (‘‘lag’’, ‘‘cumavg’’, ‘‘lag\_cumavg’’) for users to specify the covariate histories.
\begin{itemize}
\item {} 
\sphinxAtStartPar
‘‘lag’’: For any covariate L, specifying lagi\_L will add a variable to the input dataset, which contains the ith lag of L relative to the
current follow\sphinxhyphen{}up time k. For example, lag1\_L means the value of L at the time k\sphinxhyphen{}1,
lag2\_L means the value of L at the time k\sphinxhyphen{}2 etc. The value is set to 0 if k \textless{} i if there is no pre\sphinxhyphen{}baseline times.

\item {} 
\sphinxAtStartPar
‘‘cumavg’’:  For any covariate L, specifying cumavg\_L will add a variable to the input dataset, which contains the cumulative
average of L up until the current follow\sphinxhyphen{}up time k.

\item {} 
\sphinxAtStartPar
‘‘lag\_cumavg’’: For any covariate L, specifying lag\_cumavgi\_L will add a variable to the input dataset, which contains
the ith lag of the cumulative average of L relative to the current follow\sphinxhyphen{}up time k. The value is set to 0 if k \textless{} i
if there is no pre\sphinxhyphen{}baseline times.

\end{itemize}

\sphinxAtStartPar
An example for specifying the covariate model for covariate L1 based on the history functions:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{L1} \PYG{o}{\PYGZti{}} \PYG{n}{lag1\PYGZus{}L1} \PYG{o}{+} \PYG{n}{cumavg\PYGZus{}L1} \PYG{o}{+} \PYG{n}{lag\PYGZus{}cumavg1\PYGZus{}L1} \PYG{o}{+} \PYG{n}{L3} \PYG{o}{+} \PYG{n}{t0}
\end{sphinxVerbatim}


\subsubsection{Custom histories}
\label{\detokenize{Specifications/Covariate model:custom-histories}}
\sphinxAtStartPar
If users wish to use history functions that are not in the three pre\sphinxhyphen{}coded history functions, the package provides
‘‘custom\_histvars’’ and ‘‘custom\_histories’’ for users to specify their own history functions for corresponding
covariates.


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Arguments
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
\\
\hline
\sphinxAtStartPar
custom\_histvars
&
\sphinxAtStartPar
(Optional) A list of strings, each of which specifies the names of the time\sphinxhyphen{}varying covariates with user\sphinxhyphen{}specified custom histories.
\\
\hline
\sphinxAtStartPar
custom\_histories
&
\sphinxAtStartPar
(Optional) A list of function, each function is the user\sphinxhyphen{}specified custom history functions for covariates. The list
must be the same length as custom\_histvars and in the same order.
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
For each custom history function, the input should be the parameters (not necessary to use all):
\begin{itemize}
\item {} 
\sphinxAtStartPar
pool: A DataFrame that contains data table up to time t.

\item {} 
\sphinxAtStartPar
histvar: A string that specifies the name of the variable for which this history function is to be applied.

\item {} 
\sphinxAtStartPar
time\_name: A string specifying the name of the time variable in pool.

\item {} 
\sphinxAtStartPar
t: An integer specifying the current time index.

\item {} 
\sphinxAtStartPar
id\_name: A string specifying the name of the ID variable in the pool.

\end{itemize}

\sphinxAtStartPar
The function output is a dataframe ‘‘pool’’ with the new column of the historical term created.

\sphinxAtStartPar
The following is an example of creating historical functions for covariates ‘’L1’’, ‘’L2’’ and ‘’A’’ by the function
‘ave\_last3’. This function generates the average of the three most recent values of the covariate (when the
t=0, it takes the current value of the covariate; when t=1, it takes the average of the current value).
The new historical covariates are named as ave\_last3\_L1, ave\_last3\_L2, and ave\_last3\_A.

\sphinxAtStartPar
\sphinxstylestrong{Sample syntax}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{ave\PYGZus{}last3}\PYG{p}{(}\PYG{n}{pool}\PYG{p}{,} \PYG{n}{histvar}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{p}{,} \PYG{n}{t}\PYG{p}{,} \PYG{n}{id\PYGZus{}name}\PYG{p}{)}\PYG{p}{:}

  \PYG{k}{def} \PYG{n+nf}{avg\PYGZus{}func}\PYG{p}{(}\PYG{n}{df}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{p}{,} \PYG{n}{t}\PYG{p}{,} \PYG{n}{histvar}\PYG{p}{)}\PYG{p}{:}
      \PYG{k}{if} \PYG{n}{t} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{3}\PYG{p}{:}
          \PYG{n}{avg\PYGZus{}values} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{p}{(}\PYG{n}{df}\PYG{p}{[}\PYG{p}{(}\PYG{n}{df}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]} \PYG{o}{\PYGZgt{}}\PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{)} \PYG{o}{\PYGZam{}} \PYG{p}{(}\PYG{n}{df}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]} \PYG{o}{\PYGZlt{}}\PYG{o}{=} \PYG{n}{t}\PYG{p}{)}\PYG{p}{]}\PYG{p}{[}\PYG{n}{histvar}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}
      \PYG{k}{else}\PYG{p}{:}
          \PYG{n}{avg\PYGZus{}values} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{p}{(}\PYG{n}{df}\PYG{p}{[}\PYG{p}{(}\PYG{n}{df}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]} \PYG{o}{\PYGZgt{}} \PYG{n}{t} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{3}\PYG{p}{)} \PYG{o}{\PYGZam{}} \PYG{p}{(}\PYG{n}{df}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]} \PYG{o}{\PYGZlt{}}\PYG{o}{=} \PYG{n}{t}\PYG{p}{)}\PYG{p}{]}\PYG{p}{[}\PYG{n}{histvar}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}
      \PYG{k}{return} \PYG{n}{avg\PYGZus{}values}

  \PYG{n}{valid\PYGZus{}pool} \PYG{o}{=} \PYG{n}{pool}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{n}{id\PYGZus{}name}\PYG{p}{)}\PYG{o}{.}\PYG{n}{filter}\PYG{p}{(}\PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n+nb}{max}\PYG{p}{(}\PYG{n}{x}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)} \PYG{o}{\PYGZgt{}}\PYG{o}{=} \PYG{n}{t}\PYG{p}{)}
  \PYG{n}{pool}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{n}{pool}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]} \PYG{o}{==} \PYG{n}{t}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZus{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ave\PYGZus{}last3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{histvar}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}\PYG{p}{]} \PYG{o}{=} \PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{valid\PYGZus{}pool}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{n}{id\PYGZus{}name}\PYG{p}{)}\PYG{o}{.}\PYG{n}{apply}\PYG{p}{(}
      \PYG{n}{avg\PYGZus{}func}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,} \PYG{n}{t}\PYG{o}{=}\PYG{n}{t}\PYG{p}{,} \PYG{n}{histvar}\PYG{o}{=}\PYG{n}{histvar}\PYG{p}{)}\PYG{p}{)}

\PYG{k}{return} \PYG{n}{pool}

\PYG{n}{custom\PYGZus{}histvars} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{custom\PYGZus{}histories} \PYG{o}{=} \PYG{p}{[}\PYG{n}{ave\PYGZus{}last3}\PYG{p}{,} \PYG{n}{ave\PYGZus{}last3}\PYG{p}{,} \PYG{n}{ave\PYGZus{}last3}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{custom\PYGZus{}histvars} \PYG{o}{=} \PYG{n}{custom\PYGZus{}histvars}\PYG{p}{,} \PYG{n}{custom\PYGZus{}histories}\PYG{o}{=}\PYG{n}{custom\PYGZus{}histories}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
The ave\_last3 function has been included in the package, users can also call this function by:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{histories} \PYG{k+kn}{import} \PYG{n}{ave\PYGZus{}last3}
\end{sphinxVerbatim}


\subsection{Different covariate distributions}
\label{\detokenize{Specifications/Covariate model:different-covariate-distributions}}
\sphinxAtStartPar
To specify a parametric model for each covariate in pygformula, users need to specify the following arguments:


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Arguments
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
\\
\hline
\sphinxAtStartPar
covnames
&
\sphinxAtStartPar
(Required) A list of strings specifying the names of the time\sphinxhyphen{}varying covariates in obs\_data.
\\
\hline
\sphinxAtStartPar
covtypes
&
\sphinxAtStartPar
(Required) A list of strings specifying the “type” of each time\sphinxhyphen{}varying covariate included in covnames.
The supported types: “binary”, “normal”, “categorical”, “bounded normal”, “zero\sphinxhyphen{}inflated normal”,
“truncated normal”, “absorbing”, “categorical time”, “square time” and “custom”. The list must be the same
length as covnames and in the same order.
\\
\hline
\sphinxAtStartPar
covmodels
&
\sphinxAtStartPar
(Required) A list of strings, where each string is the model statement of the time\sphinxhyphen{}varying covariate. The list
must be the same length as covnames and in the same order. If a model is not required for a certain covariate,
it should be set to ‘NA’ at that index.
\\
\hline
\sphinxAtStartPar
basecovs
&
\sphinxAtStartPar
(Optional) A vector of strings specifying the names of baseline covariates in obs\_data. These covariates are not
simulated using a model but keep the same value at all time points. These covariates should not be included
in covnames.
\\
\hline
\sphinxAtStartPar
trunc\_params
&
\sphinxAtStartPar
(Optional) A list, at the index where the covtype is set to “truncated normal”, the element contains two elements.
The first element specifies the truncated value and the second element specifies the truncated direction
(‘left’ or ‘right’). The values at remaining indexes are set to ‘NA’. The list must be the same length as
covnames and in the same order.
\\
\hline
\sphinxAtStartPar
time\_thresholds
&
\sphinxAtStartPar
(Optional) A list of integers that splits the time points into different intervals. It is used to create the time variable
of “categorical time”.
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
When there are confounders to be adjusted, users need to specify the names of time\sphinxhyphen{}varying covariates in ‘‘covnames’’, the distribution type
of each covariate in ‘‘covtypes’’, as well as the model statement for each covariate in ‘‘covmodels’’.
In addition, if there are time\sphinxhyphen{}fixed baseline covariates, they should be specified in the argument ‘‘basecovs’’.
If the covariate type is ‘‘truncated normal’’, the ‘‘trunc\_params’’ argument should be also defined which contains
the required truncated direction and truncated value. If the covariate type is ‘‘categorical time’’, users should
also define the ‘‘time\_thresholds’’ argument to create a desired categorization of time.
In the following, this section shows examples for different covariate distributions to show how to specify the above arguments
in specific examples during the usage.

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
For the ‘‘covmodels’’ argument which specifies the model statement for each covariate, users need to be careful to
avoid the loop between covariates, i.e., in each covariate model statement, the independent variable and dependent
variable should follow the direction in the DAG (directed acyclic graph). For example, if the covariate A is the
dependent variable of the covariate B (A \textasciitilde{} B), then the covariate B should not be the dependent variable of the
covariate A (B \textasciitilde{} A).
\end{sphinxadmonition}


\subsubsection{Binary}
\label{\detokenize{Specifications/Covariate model:binary}}
\sphinxAtStartPar
When the covariate is binary, in the fitting step, the input data is used to estimate a generalized linear model where
the family function is binomial. Then, in the simulation step, the mean of the covariate conditional on history
at each time step is estimated via the coefficients of the fitted model, the covariate values are simulated
by sampling from a Bernoulli distribution with parameter the conditional probability.

\sphinxAtStartPar
\sphinxstylestrong{Sample syntax}:

\sphinxAtStartPar
An example where the covariate ‘’L1’’ is binomial distribution

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1 \PYGZti{} lag1\PYGZus{}A + lag2\PYGZus{}A + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L1 + L2 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{basecovs} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{covnames} \PYG{o}{=} \PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes} \PYG{o}{=} \PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels} \PYG{o}{=} \PYG{n}{covmodels}\PYG{p}{,} \PYG{n}{basecovs} \PYG{o}{=} \PYG{n}{basecovs}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Running example} \sphinxhref{https://github.com/CausalInference/pygformula/blob/main/running\_examples/test\_binary\_cov.py}{{[}code{]}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{static}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1 \PYGZti{} lag1\PYGZus{}A + lag2\PYGZus{}A + lag\PYGZus{}cumavg1\PYGZus{}L1 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
           \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L1 + lag\PYGZus{}cumavg1\PYGZus{}L1 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{basecovs} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} L1 + A + lag1\PYGZus{}A + lag1\PYGZus{}L1 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}type} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Never treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Always treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}


\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,} \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{Intervention2\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,} \PYG{n}{basecovs}\PYG{o}{=}\PYG{n}{basecovs}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}type}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{binary_cov_example_output}.png}\hspace*{\fill}}
\end{quote}

\sphinxAtStartPar
Note that in this section, all demonstration examples use the same static interventions
(‘‘Never treat’’ and ‘‘Always treat’’), and are applied in the survival outcome case.
Please refer to {\hyperref[\detokenize{Specifications/Intervention::doc}]{\sphinxcrossref{\DUrole{doc}{Intervention}}}} part for more types of intervention,
and {\hyperref[\detokenize{Specifications/Outcome model::doc}]{\sphinxcrossref{\DUrole{doc}{Outcome model}}}} part for more types of outcome.


\subsubsection{Normal}
\label{\detokenize{Specifications/Covariate model:normal}}
\sphinxAtStartPar
When the covariate is normal, in the fitting step, the input data is used to estimate a generalized linear model where
the family function is gaussian. Then, in the simulation step, the mean of the covariate conditional on history
at each time step is estimated via the coefficients of the fitted model, the covariate values are simulated
by sampling from a normal distribution with mean this conditional mean and variance the residual mean squared error
from the fitted model. Values generated outside the observed range for the covariate are set to the minimum or maximum of this range.

\sphinxAtStartPar
\sphinxstylestrong{Sample syntax}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} lag1\PYGZus{}A + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L2 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{basecovs} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{covnames} \PYG{o}{=} \PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes} \PYG{o}{=} \PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels} \PYG{o}{=} \PYG{n}{covmodels}\PYG{p}{,} \PYG{n}{basecovs} \PYG{o}{=} \PYG{n}{basecovs}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Running example} \sphinxhref{https://github.com/CausalInference/pygformula/blob/main/running\_examples/test\_normal\_cov.py}{{[}code{]}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{static}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} lag1\PYGZus{}A + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
           \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L2 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{basecovs} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} L2 + A + lag1\PYGZus{}A + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}type} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Never treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Always treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}


\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,} \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{Intervention2\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,} \PYG{n}{basecovs}\PYG{o}{=}\PYG{n}{basecovs}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}type}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{normal_cov_example_output}.png}\hspace*{\fill}}
\end{quote}


\subsubsection{Categorical}
\label{\detokenize{Specifications/Covariate model:categorical}}
\sphinxAtStartPar
When the covariate is categorical, in the fitting step, the input data is used to estimate
a multinomial logistic regression model. Then, in the simulation step, the probability that a covariate
takes a particular level conditional on history is estimated via the coefficients of
the fitted model. The covariate values are simulated at each time step by sampling from a multinoulli distribution with parameters these estimated
conditional probabilities of the fitted model.

\sphinxAtStartPar
\sphinxstylestrong{Sample syntax}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{categorical}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L \PYGZti{} C(lag1\PYGZus{}L) + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
              \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} C(L) + C(lag1\PYGZus{}L) + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{covnames} \PYG{o}{=} \PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes} \PYG{o}{=} \PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels} \PYG{o}{=} \PYG{n}{covmodels}\PYG{p}{,}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
Note that when the covariate model statement contains any categorical variable, such as ‘‘lag1\_L’’ or ‘‘L’’,
e.g., in the example above, users need to add a ‘‘C( )’’ on the variable indicating it’s categorical.

\sphinxAtStartPar
\sphinxstylestrong{Running example} \sphinxhref{https://github.com/CausalInference/pygformula/blob/main/running\_examples/test\_categorical\_cov.py}{{[}code{]}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{static}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}categorical}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}categorical}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{categorical}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L \PYGZti{} C(lag1\PYGZus{}L) + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
              \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} C(L) + C(lag1\PYGZus{}L) + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} C(lag1\PYGZus{}L) + A}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Never treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Always treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}


\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,} \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{Intervention2\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,}  \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{categorical_cov_example_output}.png}\hspace*{\fill}}
\end{quote}


\subsubsection{Bounded normal}
\label{\detokenize{Specifications/Covariate model:bounded-normal}}
\sphinxAtStartPar
When the covariate is bounded normal, the observed covariate values are first standardized to the interval {[}0, 1{]}, inclusive,
by subtracting the minimum value and dividing by the range. In the fitting step, the input data with standardized covariate
is used to estimate a generalized linear model where the family function is gaussian. In the simulation step,
the mean of the covariate conditional on history at each time step is estimated via the coefficients of the
fitted model, the standardized covariate values are simulated by sampling from a normal distribution with mean this conditional mean and variance the
residual mean squared error from the fitted model. Finally, the simulated standardized values are then transformed back to the original scale,
and values generated outside the observed range for the covariate are set to the minimum or maximum of this range.

\sphinxAtStartPar
\sphinxstylestrong{Sample syntax}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bounded normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} lag1\PYGZus{}A + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L2 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{basecovs} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{covnames} \PYG{o}{=} \PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes} \PYG{o}{=} \PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels} \PYG{o}{=} \PYG{n}{covmodels}\PYG{p}{,} \PYG{n}{basecovs} \PYG{o}{=} \PYG{n}{basecovs}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Running example} \sphinxhref{https://github.com/CausalInference/pygformula/blob/main/running\_examples/test\_bounded\_normal\_cov.py}{{[}code{]}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{static}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bounded normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} lag1\PYGZus{}A + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
           \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L2 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{basecovs} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} L2 + A + lag1\PYGZus{}A + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}type} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Never treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Always treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}


\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,} \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{Intervention2\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,} \PYG{n}{basecovs}\PYG{o}{=}\PYG{n}{basecovs}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}type}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{bounded_normal_cov_example}.png}\hspace*{\fill}}
\end{quote}


\subsubsection{Zero\sphinxhyphen{}inflated normal}
\label{\detokenize{Specifications/Covariate model:zero-inflated-normal}}
\sphinxAtStartPar
When the covariate is zero\sphinxhyphen{}inflated normal, in the fitting step, the input data will be added an indicator variable
by setting the covariate values that are greater than 0 to 1 and keeping the original zeros values.
The input data with the added indicator variable is used to first fit a generalized linear model where
the family function is binomial. Then, the input data with positive values at the covariate is used to
fit a generalized linear model where the family function is gaussian. In the simulation step,
the simulated covariate values are created by first generating an indicator of whether the covariate value is zero
or non\sphinxhyphen{}zero from a Bernoulli distribution with the parameter the probability from the first fitted model. Covariate
values are then generated from a normal distribution with the mean of the second fitted model
and multiplied by the generated zero indicator. The simulated non\sphinxhyphen{}zero covariate values that fall outside
the observed range are set to the minimum or maximum of the range of non\sphinxhyphen{}zero observed values
of the covariate.

\sphinxAtStartPar
\sphinxstylestrong{Sample syntax}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{zero\PYGZhy{}inflated normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L \PYGZti{} lag1\PYGZus{}L + lag1\PYGZus{}A + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
              \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{covnames} \PYG{o}{=} \PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes} \PYG{o}{=} \PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels} \PYG{o}{=} \PYG{n}{covmodels}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Running example} \sphinxhref{https://github.com/CausalInference/pygformula/blob/main/running\_examples/test\_zero\_inflated\_normal\_cov.py}{{[}code{]}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{static}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}zero\PYGZus{}inflated\PYGZus{}normal}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{zero\PYGZhy{}inflated normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L \PYGZti{} lag1\PYGZus{}L + lag1\PYGZus{}A + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
              \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} L + A + t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}type} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Never treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Always treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}


\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,} \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{Intervention2\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}type}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{zero_inflated_normal_cov_example}.png}\hspace*{\fill}}
\end{quote}


\subsubsection{Truncated normal}
\label{\detokenize{Specifications/Covariate model:truncated-normal}}
\sphinxAtStartPar
When the covariate is truncated normal, in the fitting step, the input data
is used to fit a truncated normal regression model. In the simulation step, the mean of the covariate conditional on history at each time step is estimated via the coefficients of the
fitted model, then the simulated covariate values are generated by sampling from a truncated normal
distribution with the covariate mean from the fitted model. The generated covariate values that fall outside the observed range
are set to the minimum or maximum of the observed range.

\sphinxAtStartPar
\sphinxstylestrong{Sample syntax}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{truncated normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L \PYGZti{} lag1\PYGZus{}A + lag1\PYGZus{}L + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + lag1\PYGZus{}L + L + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{trunc\PYGZus{}params} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{right}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NA}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{covnames} \PYG{o}{=} \PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes} \PYG{o}{=} \PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels} \PYG{o}{=} \PYG{n}{covmodels}\PYG{p}{,} \PYG{n}{trunc\PYGZus{}params}\PYG{o}{=}\PYG{n}{trunc\PYGZus{}params}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
Note that the elements in the ‘‘trunc\_points’’ list also follows the same order as ‘‘covnames’’,
in the position where its corresponding covariate is truncated normal, it should be a list with two elements,
otherwise it should be ‘NA’. In the list of two elements, the first one should be the truncated value of the covariate,
and the second one should be the truncated direction (‘left’ or ‘right’) of the covariate.

\sphinxAtStartPar
\sphinxstylestrong{Running example} \sphinxhref{https://github.com/CausalInference/pygformula/blob/main/running\_examples/test\_truncated\_normal.py}{{[}code{]}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{static}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}truncated\PYGZus{}normal}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}truncated\PYGZus{}normal}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{truncated normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L \PYGZti{} lag1\PYGZus{}A + lag1\PYGZus{}L + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + lag1\PYGZus{}L + L + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{trunc\PYGZus{}params} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{right}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NA}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} L + A + t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}type} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Never treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Always treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,} \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{Intervention2\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,} \PYG{n}{trunc\PYGZus{}params}\PYG{o}{=}\PYG{n}{trunc\PYGZus{}params}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}type}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{truncated_normal_cov_example}.png}\hspace*{\fill}}
\end{quote}


\subsubsection{Absorbing}
\label{\detokenize{Specifications/Covariate model:absorbing}}
\sphinxAtStartPar
Absorbing means that once the covariate value switches to 1 at one time step, it stays 1 at all subsequent times.
When the covariate is absorbing, the input data records where the value of the covariate at k\sphinxhyphen{}1 is 0
for all time steps k is used to fit a generalized linear model where the family function is binomial.
Then in the simulation step, the mean of the covariate conditional on history
at each time step is estimated via the coefficients of the fitted model, the covariate values are simulated
by sampling from a Bernoulli distribution with parameter the conditional mean. Once a 1 is first generated, the covariate value at that
time and all subsequent times is set to 1.

\sphinxAtStartPar
\sphinxstylestrong{Sample syntax}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{absorbing}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L \PYGZti{} lag1\PYGZus{}L + lag1\PYGZus{}A + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{covnames} \PYG{o}{=} \PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes} \PYG{o}{=} \PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covparams} \PYG{o}{=} \PYG{n}{covparams}\PYG{p}{,}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Running example} \sphinxhref{https://github.com/CausalInference/pygformula/blob/main/running\_examples/test\_absorbing\_cov.py}{{[}code{]}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{static}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}absorbing\PYGZus{}data}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}absorbing\PYGZus{}data}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{absorbing}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L \PYGZti{} lag1\PYGZus{}L + lag1\PYGZus{}A + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
              \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} L + A + t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}type} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Never treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Always treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,} \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{Intervention2\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}type}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{absorbing_cov_example_output}.png}\hspace*{\fill}}
\end{quote}


\subsubsection{Time variable}
\label{\detokenize{Specifications/Covariate model:time-variable}}
\sphinxAtStartPar
When users assume that the distributions of time\sphinxhyphen{}varying covariates
depend on a function of the time index, they need to specify an additional time variable. The package has two pre\sphinxhyphen{}coded
time variable: ‘‘categorical time’’ and ‘‘square time’’.
The ‘‘categorical time’’ is a variable that categorizes the time index to different time categories. The ‘‘square time’’
is the squared time index.

\sphinxAtStartPar
\sphinxstylestrong{Sample syntax of categorical time}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0\PYGZus{}f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bounded normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{categorical time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1 \PYGZti{} lag1\PYGZus{}A + lag2\PYGZus{}A + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0 + C(t0\PYGZus{}f)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
           \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} lag1\PYGZus{}A + L1 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0 + C(t0\PYGZus{}f)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
           \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L1 + L2 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0 + C(t0\PYGZus{}f)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
           \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NA}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{time\PYGZus{}thresholds} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{covnames} \PYG{o}{=} \PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes} \PYG{o}{=} \PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covparams} \PYG{o}{=} \PYG{n}{covparams}\PYG{p}{,} \PYG{n}{time\PYGZus{}thresholds} \PYG{o}{=} \PYG{n}{time\PYGZus{}thresholds}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
The argument ‘‘time\_thresholds’’ creates indicators for categorizing the time index,
The time index values inside the interval from each adjacent array (right\sphinxhyphen{}closed) form a category.
for example, setting time\_thresholds = {[}1, 3, 5{]} in input data with 7 time points means that categorizing the time index to four time categories
(category 1: 0 \textless{}= time index \textless{}=1, category 2 : 1 \textless{} time index \textless{}=3, category 3 : 3 \textless{} time index \textless{}=5,
category 4 : 5 \textless{} time index \textless{}= 6).

\sphinxAtStartPar
Users should specify the name of categorical time variable by adding a ‘‘\_f’’ after the time name,
and specify its type as ‘categorical time’ in covtypes argument. In the covparams argument,
the corresponding position of the categorical time variable should be padded with NA.
Note that when using the new categorical time variable in the model statement, e.g., ‘‘t0\_f’’ in
the syntax example above, C() should be added.

\sphinxAtStartPar
\sphinxstylestrong{Running example} \sphinxhref{https://github.com/CausalInference/pygformula/blob/main/running\_examples/test\_categorical\_time.py}{{[}code{]}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{static}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0\PYGZus{}f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bounded normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{categorical time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1 \PYGZti{} lag1\PYGZus{}A + lag2\PYGZus{}A + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0 + C(t0\PYGZus{}f)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
           \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} lag1\PYGZus{}A + L1 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0 + C(t0\PYGZus{}f)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
           \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L1 + L2 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0 + C(t0\PYGZus{}f)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
           \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NA}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{time\PYGZus{}thresholds} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{]}

\PYG{n}{basecovs} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} L1 + L2 + L3 + A + lag1\PYGZus{}A + lag1\PYGZus{}L1 + lag1\PYGZus{}L2 + t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}type} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Never treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Always treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}


\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,} \PYG{n}{time\PYGZus{}thresholds} \PYG{o}{=} \PYG{n}{time\PYGZus{}thresholds}\PYG{p}{,}
    \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{Intervention2\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,} \PYG{n}{basecovs}\PYG{o}{=}\PYG{n}{basecovs}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}type}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{categorical_time_cov_example}.png}\hspace*{\fill}}
\end{quote}

\sphinxAtStartPar
\sphinxstylestrong{Sample syntax of square time}:

\sphinxAtStartPar
Note that when the covariate type is ‘‘square time’’, the corresponding covariate name should be set to the merged strings
of ‘square’ and the time name in the data, e.g., ‘square\_t0’.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{square\PYGZus{}t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bounded normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{square time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1 \PYGZti{} lag1\PYGZus{}A + lag2\PYGZus{}A + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0 + square\PYGZus{}t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
           \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} lag1\PYGZus{}A + L1 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0 + square\PYGZus{}t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
           \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L1 + L2 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0 + square\PYGZus{}t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
           \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NA}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{covnames} \PYG{o}{=} \PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes} \PYG{o}{=} \PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covparams} \PYG{o}{=} \PYG{n}{covparams}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Running example} \sphinxhref{https://github.com/CausalInference/pygformula/blob/main/running\_examples/test\_square\_time.py}{{[}code{]}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{static}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{square\PYGZus{}t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bounded normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{square time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1 \PYGZti{} lag1\PYGZus{}A + lag2\PYGZus{}A + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0 + square\PYGZus{}t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
           \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} lag1\PYGZus{}A + L1 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0 + square\PYGZus{}t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
           \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L1 + L2 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0 + square\PYGZus{}t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
           \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NA}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{basecovs} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} L1 + L2 + L3 + A + lag1\PYGZus{}A + lag1\PYGZus{}L1 + lag1\PYGZus{}L2 + t0 + square\PYGZus{}t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}type} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Never treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Always treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}


\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,} \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{Intervention2\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,} \PYG{n}{basecovs}\PYG{o}{=}\PYG{n}{basecovs}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}type}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}


\subsubsection{Custom}
\label{\detokenize{Specifications/Covariate model:custom}}
\sphinxAtStartPar
In addition to the covariate types above, the package also allows users to choose their own covariate distributions for
estimation. In this case, the corresponding covtype should be set to ‘‘custom’’, users need to specify the custom
fit function and the predict function, which will be called by the arguments ‘‘covfits\_custom’’ and ‘‘covpredict\_custom’’.


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Arguments
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
\\
\hline
\sphinxAtStartPar
covfits\_custom
&
\sphinxAtStartPar
(Optional) A list, at the index where the covtype is set to “custom”, the element is a user\sphinxhyphen{}specified fit function,
otherwise it should be set to ‘NA’. The list must be the same length as covnames and in the same order.
\\
\hline
\sphinxAtStartPar
covpredict\_custom
&
\sphinxAtStartPar
(Optional) A list, at the index where the covtype is set to “custom”, the element is a user\sphinxhyphen{}specified predict function,
otherwise it should be set to ‘NA’.
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
Each custom fit function has input parameters (not necessary to use all):
\begin{itemize}
\item {} 
\sphinxAtStartPar
covmodel: model statement of the covariate

\item {} 
\sphinxAtStartPar
covname: the covariate name

\item {} 
\sphinxAtStartPar
fit\_data: data used to fit the covariate model

\end{itemize}

\sphinxAtStartPar
and return a fitted model which is used to make prediction in the simulation step.

\sphinxAtStartPar
An example using random forest to fit a covariate model:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{fit\PYGZus{}rf}\PYG{p}{(}\PYG{n}{covmodel}\PYG{p}{,} \PYG{n}{covname}\PYG{p}{,} \PYG{n}{fit\PYGZus{}data}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{max\PYGZus{}depth} \PYG{o}{=} \PYG{l+m+mi}{2}
    \PYG{n}{y\PYGZus{}name}\PYG{p}{,} \PYG{n}{x\PYGZus{}name} \PYG{o}{=} \PYG{n}{re}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZti{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{covmodel}\PYG{o}{.}\PYG{n}{replace}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{x\PYGZus{}name} \PYG{o}{=} \PYG{n}{re}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{x\PYGZus{}name}\PYG{o}{.}\PYG{n}{replace}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{y} \PYG{o}{=} \PYG{n}{fit\PYGZus{}data}\PYG{p}{[}\PYG{n}{y\PYGZus{}name}\PYG{p}{]}\PYG{o}{.}\PYG{n}{to\PYGZus{}numpy}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{X} \PYG{o}{=} \PYG{n}{fit\PYGZus{}data}\PYG{p}{[}\PYG{n}{x\PYGZus{}name}\PYG{p}{]}\PYG{o}{.}\PYG{n}{to\PYGZus{}numpy}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{fit\PYGZus{}rf} \PYG{o}{=} \PYG{n}{RandomForestRegressor}\PYG{p}{(}\PYG{n}{max\PYGZus{}depth}\PYG{o}{=}\PYG{n}{max\PYGZus{}depth}\PYG{p}{,} \PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}
    \PYG{n}{fit\PYGZus{}rf}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{X}\PYG{p}{,} \PYG{n}{y}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{fit\PYGZus{}rf}
\end{sphinxVerbatim}

\sphinxAtStartPar
Each custom predict function has parameters (not necessary to use all):
\begin{itemize}
\item {} 
\sphinxAtStartPar
covmodel: model statement of the covariate

\item {} 
\sphinxAtStartPar
new\_df: simulated data table at time t.

\item {} 
\sphinxAtStartPar
fit: fitted model of the custom function

\end{itemize}

\sphinxAtStartPar
and return a list of predicted values at time t.

\sphinxAtStartPar
The custom predict function for the random forest model:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{predict\PYGZus{}rf}\PYG{p}{(}\PYG{n}{covmodel}\PYG{p}{,} \PYG{n}{new\PYGZus{}df}\PYG{p}{,} \PYG{n}{fit}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{y\PYGZus{}name}\PYG{p}{,} \PYG{n}{x\PYGZus{}name} \PYG{o}{=} \PYG{n}{re}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZti{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{covmodel}\PYG{o}{.}\PYG{n}{replace}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{x\PYGZus{}name} \PYG{o}{=} \PYG{n}{re}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{x\PYGZus{}name}\PYG{o}{.}\PYG{n}{replace}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{X} \PYG{o}{=} \PYG{n}{new\PYGZus{}df}\PYG{p}{[}\PYG{n}{x\PYGZus{}name}\PYG{p}{]}\PYG{o}{.}\PYG{n}{to\PYGZus{}numpy}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{prediction} \PYG{o}{=} \PYG{n}{fit}\PYG{o}{.}\PYG{n}{predict}\PYG{p}{(}\PYG{n}{X}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{prediction}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Sample syntax}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{covfits\PYGZus{}custom} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NA}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{fit\PYGZus{}rf}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NA}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covpredict\PYGZus{}custom} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NA}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{predict\PYGZus{}rf}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NA}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{covfits\PYGZus{}custom} \PYG{o}{=} \PYG{n}{covfits\PYGZus{}custom}\PYG{p}{,} \PYG{n}{covfits\PYGZus{}custom} \PYG{o}{=} \PYG{n}{covpredict\PYGZus{}custom}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Running examples} \sphinxhref{https://github.com/CausalInference/pygformula/blob/main/running\_examples/test\_fit\_random\_forest.py}{{[}code{]}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{re}
\PYG{k+kn}{from} \PYG{n+nn}{sklearn}\PYG{n+nn}{.}\PYG{n+nn}{ensemble} \PYG{k+kn}{import} \PYG{n}{RandomForestRegressor}
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{static}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{custom}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1 \PYGZti{} lag1\PYGZus{}A + lag2\PYGZus{}A + lag1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} lag1\PYGZus{}A + L1 + lag1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L1 + L2 +lag1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}


\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} L1 + L2 + A}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{c+c1}{\PYGZsh{} define interventions}
\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Never treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Always treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}


\PYG{k}{def} \PYG{n+nf}{fit\PYGZus{}rf}\PYG{p}{(}\PYG{n}{covmodel}\PYG{p}{,} \PYG{n}{covname}\PYG{p}{,} \PYG{n}{fit\PYGZus{}data}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{max\PYGZus{}depth} \PYG{o}{=} \PYG{l+m+mi}{2}
    \PYG{n}{y\PYGZus{}name}\PYG{p}{,} \PYG{n}{x\PYGZus{}name} \PYG{o}{=} \PYG{n}{re}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZti{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{covmodel}\PYG{o}{.}\PYG{n}{replace}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{x\PYGZus{}name} \PYG{o}{=} \PYG{n}{re}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{x\PYGZus{}name}\PYG{o}{.}\PYG{n}{replace}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{y} \PYG{o}{=} \PYG{n}{fit\PYGZus{}data}\PYG{p}{[}\PYG{n}{y\PYGZus{}name}\PYG{p}{]}\PYG{o}{.}\PYG{n}{to\PYGZus{}numpy}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{X} \PYG{o}{=} \PYG{n}{fit\PYGZus{}data}\PYG{p}{[}\PYG{n}{x\PYGZus{}name}\PYG{p}{]}\PYG{o}{.}\PYG{n}{to\PYGZus{}numpy}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{fit\PYGZus{}rf} \PYG{o}{=} \PYG{n}{RandomForestRegressor}\PYG{p}{(}\PYG{n}{max\PYGZus{}depth}\PYG{o}{=}\PYG{n}{max\PYGZus{}depth}\PYG{p}{,} \PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}
    \PYG{n}{fit\PYGZus{}rf}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{X}\PYG{p}{,} \PYG{n}{y}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{fit\PYGZus{}rf}

\PYG{k}{def} \PYG{n+nf}{predict\PYGZus{}rf}\PYG{p}{(}\PYG{n}{covmodel}\PYG{p}{,} \PYG{n}{new\PYGZus{}df}\PYG{p}{,} \PYG{n}{fit}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{y\PYGZus{}name}\PYG{p}{,} \PYG{n}{x\PYGZus{}name} \PYG{o}{=} \PYG{n}{re}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZti{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{covmodel}\PYG{o}{.}\PYG{n}{replace}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{x\PYGZus{}name} \PYG{o}{=} \PYG{n}{re}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{x\PYGZus{}name}\PYG{o}{.}\PYG{n}{replace}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{X} \PYG{o}{=} \PYG{n}{new\PYGZus{}df}\PYG{p}{[}\PYG{n}{x\PYGZus{}name}\PYG{p}{]}\PYG{o}{.}\PYG{n}{to\PYGZus{}numpy}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{prediction} \PYG{o}{=} \PYG{n}{fit}\PYG{o}{.}\PYG{n}{predict}\PYG{p}{(}\PYG{n}{X}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{prediction}

\PYG{n}{covfits\PYGZus{}custom} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NA}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{fit\PYGZus{}rf}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NA}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covpredict\PYGZus{}custom} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NA}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{predict\PYGZus{}rf}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NA}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,} \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{Intervention2\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,}  \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,}
    \PYG{n}{covfits\PYGZus{}custom} \PYG{o}{=} \PYG{n}{covfits\PYGZus{}custom}\PYG{p}{,} \PYG{n}{covpredict\PYGZus{}custom}\PYG{o}{=}\PYG{n}{covpredict\PYGZus{}custom}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{random_forest_cov}.png}\hspace*{\fill}}
\end{quote}


\section{Outcome model}
\label{\detokenize{Specifications/Outcome model:outcome-model}}\label{\detokenize{Specifications/Outcome model:id1}}\label{\detokenize{Specifications/Outcome model::doc}}
\sphinxAtStartPar
The package supports g\sphinxhyphen{}formula analysis on three types of outcomes: survival outcomes, fixed binary
end of follow\sphinxhyphen{}up outcomes and continuous end of follow\sphinxhyphen{}up outcomes.

\sphinxAtStartPar
For all types of outcomes, users should specify the name of outcome in the argument ‘‘outcome\_name’’, and the model
statement for outcome variable in the argument ‘‘outcome\_model’’. If users are interested in the probability of failing of an event by
a specified follow\sphinxhyphen{}up time k under different interventions, they need to specify the type of outcome as
‘survival’ in the argument ‘‘outcome\_type’’. If users are interested in the outcome mean at a fixed time point,
and the outcome distribution is binary, they need to specify the type of outcome as
‘binary\_eof’. Similarly, they need to specify the type of outcome as ‘continuous\_eof’ when the distribution of the outcome is continuous.


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Arguments
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
\\
\hline
\sphinxAtStartPar
outcome\_name
&
\sphinxAtStartPar
(Required) A string specifying the name of the outcome variable in obs\_data.
\\
\hline
\sphinxAtStartPar
outcome\_model
&
\sphinxAtStartPar
(Required) A string specifying the model statement for the outcome variable.
\\
\hline
\sphinxAtStartPar
outcome\_type
&
\sphinxAtStartPar
(Required) A string specifying the “type” of outcome. The possible “types” are: “survival”, “continuous\_eof”, and “binary\_eof”.
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\subsection{Survival outcome}
\label{\detokenize{Specifications/Outcome model:survival-outcome}}
\sphinxAtStartPar
For survival outcomes, the package will output estimates of contrasts in failure risks by a specified follow\sphinxhyphen{}up time k
under different user\sphinxhyphen{}specified interventions.

\sphinxAtStartPar
\sphinxstylestrong{Sample syntax}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} L1 + L2 + L3 + A + lag1\PYGZus{}A + lag1\PYGZus{}L1 + lag1\PYGZus{}L2 + t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}type} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{l+m+mi}{5}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type} \PYG{o}{=} \PYG{n}{outcome\PYGZus{}type}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
Users can also specify the follow\sphinxhyphen{}up time of interest for survival outcome by the argument ‘‘time\_points’’.

\sphinxAtStartPar
\sphinxstylestrong{Running example} \sphinxhref{https://github.com/CausalInference/pygformula/blob/main/running\_examples/get\_started\_example.py}{{[}code{]}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{static}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bounded normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1 \PYGZti{} lag1\PYGZus{}A + lag2\PYGZus{}A + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
           \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} lag1\PYGZus{}A + L1 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
           \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L1 + L2 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{basecovs} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} L1 + L2 + L3 + A + lag1\PYGZus{}A + lag1\PYGZus{}L1 + lag1\PYGZus{}L2 + t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}type} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Never treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Always treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}


\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,} \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,} \PYG{n}{basecovs}\PYG{o}{=}\PYG{n}{basecovs}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}type}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{Intervention2\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{get_started_example}.png}\hspace*{\fill}}
\end{quote}


\subsection{Binary end of follow\sphinxhyphen{}up outcome}
\label{\detokenize{Specifications/Outcome model:binary-end-of-follow-up-outcome}}
\sphinxAtStartPar
For binary end of follow\sphinxhyphen{}up outcomes, the package will output estimates of contrasts in the outcome probability
under different user\sphinxhyphen{}specified treatment strategies.

\sphinxAtStartPar
\sphinxstylestrong{Sample syntax}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} L1 + A + lag1\PYGZus{}A + lag1\PYGZus{}L1 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}type} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary\PYGZus{}eof}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type} \PYG{o}{=} \PYG{n}{outcome\PYGZus{}type}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Running example}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{threshold}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}binary\PYGZus{}eof}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}binary\PYGZus{}eof}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{zero\PYGZhy{}inflated normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1 \PYGZti{} lag1\PYGZus{}A + lag2\PYGZus{}A + lag\PYGZus{}cumavg1\PYGZus{}L1 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} lag1\PYGZus{}A + L1 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L1 + L2 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{basecovs} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} L1 + A + lag1\PYGZus{}A + lag1\PYGZus{}L1 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}type} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary\PYGZus{}eof}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Threshold intervention}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{threshold}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{n+nb}{float}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{inf}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{]}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,} \PYG{n}{basecovs}\PYG{o}{=}\PYG{n}{basecovs}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}type}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{binary_eof_example_output}.png}\hspace*{\fill}}
\end{quote}


\subsection{Continuous end of follow\sphinxhyphen{}up outcome}
\label{\detokenize{Specifications/Outcome model:continuous-end-of-follow-up-outcome}}
\sphinxAtStartPar
For continuous end of follow\sphinxhyphen{}up outcomes, the package will output estimates of contrasts in the outcome mean
under different user\sphinxhyphen{}specified treatment strategies.

\sphinxAtStartPar
\sphinxstylestrong{Sample syntax}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} C(L1) + L2 + A}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}type} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{continuous\PYGZus{}eof}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{gformula\PYGZus{}nice}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type} \PYG{o}{=} \PYG{n}{outcome\PYGZus{}type}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Running example}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{static}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}continuous\PYGZus{}eof}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}continuous\PYGZus{}eof}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{categorical}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1 \PYGZti{} C(lag1\PYGZus{}L1) + lag1\PYGZus{}L2 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} lag1\PYGZus{}L2 + C(lag1\PYGZus{}L1) + lag1\PYGZus{}A + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
              \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} C(L1) + L2 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{basecovs} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} C(L1) + L2 + A}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}type} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{continuous\PYGZus{}eof}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Never treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Always treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}


\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{int\PYGZus{}descript}\PYG{o}{=}\PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{Intervention2\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,} \PYG{n}{basecovs}\PYG{o}{=}\PYG{n}{basecovs}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}type}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{continuous_eof_example_output}.png}\hspace*{\fill}}
\end{quote}


\section{Censoring event}
\label{\detokenize{Specifications/Censoring event:censoring-event}}\label{\detokenize{Specifications/Censoring event:id1}}\label{\detokenize{Specifications/Censoring event::doc}}
\sphinxAtStartPar
In the presence of censoring, the name of the censoring variable in the input data should be specified,
users also need to specify a censor model.
Here the censor model is used for nonparametric estimate of natural course which applies inverse probability weighting method \sphinxstepexplicit %
\begin{footnote}[1]\phantomsection\label{\thesphinxscope.1}%
\sphinxAtStartFootnote
Yu\sphinxhyphen{}Han Chiu, Lan Wen, Sean McGrath, Roger Logan, Issa J Dahabreh, and Miguel A Hernán. 2022. Evaluating model specification when using the parametric g\sphinxhyphen{}formula in the presence of censoring. American Journal of Epidemiology.
%
\end{footnote}.
Meanwhile, the compared parametric g\sphinxhyphen{}formula involves a hypothetical intervention to abolish censoring.

\sphinxAtStartPar
The arguments for censoring events:


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Arguments
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
\\
\hline
\sphinxAtStartPar
censor\_name
&
\sphinxAtStartPar
(Optional) A string specifying the name of the censoring variable in obs\_data.
\\
\hline
\sphinxAtStartPar
censor\_model
&
\sphinxAtStartPar
(Optional) A string specifying the model statement for the censoring variable.
\\
\hline
\sphinxAtStartPar
ipw\_cutoff\_quantile
&
\sphinxAtStartPar
(Optional) A percentile by which to truncate inverse probability weights.
\\
\hline
\sphinxAtStartPar
ipw\_cutoff\_value
&
\sphinxAtStartPar
(Optional) A cutoff value by which to truncate inverse probability weights.
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
Users may specify a cutoff value (in the argument ‘‘ipw\_cutoff\_quantile’’) or a cutoff quantile
(in the argument ‘‘ipw\_cutoff\_value’’) to truncate inverse probability weight.

\sphinxAtStartPar
\sphinxstylestrong{Sample syntax}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{censor\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{censor\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C \PYGZti{} A + L}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{censor\PYGZus{}name} \PYG{o}{=} \PYG{n}{censor\PYGZus{}name}\PYG{p}{,} \PYG{n}{censor\PYGZus{}model} \PYG{o}{=} \PYG{n}{censor\PYGZus{}model}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
When there are categorical covariates (which are assigned a ‘C’ symbol) in the model statement of censoring variable,
please name the censoring variable any name except ‘C’ to avoild name confusion.
\end{sphinxadmonition}

\sphinxAtStartPar
\sphinxstylestrong{Running example} \sphinxhref{https://github.com/CausalInference/pygformula/blob/main/running\_examples/test\_censor.py}{{[}code{]}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{static}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}censor\PYGZus{}data}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}censor\PYGZus{}data}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L \PYGZti{} lag1\PYGZus{}L + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} A + L}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{censor\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{censor\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C \PYGZti{} A + L}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Never treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Always treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}


\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,}
    \PYG{n}{int\PYGZus{}descript}\PYG{o}{=}\PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{Intervention2\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{censor\PYGZus{}name}\PYG{o}{=} \PYG{n}{censor\PYGZus{}name}\PYG{p}{,} \PYG{n}{censor\PYGZus{}model}\PYG{o}{=}\PYG{n}{censor\PYGZus{}model}\PYG{p}{,}
    \PYG{n}{covnames} \PYG{o}{=} \PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes} \PYG{o}{=} \PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels} \PYG{o}{=} \PYG{n}{covmodels}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{censor_example_output}.png}\hspace*{\fill}}
\end{quote}


\section{Competing event}
\label{\detokenize{Specifications/Competing event:competing-event}}\label{\detokenize{Specifications/Competing event:id1}}\label{\detokenize{Specifications/Competing event::doc}}
\sphinxAtStartPar
In the presence of competing events, users may choose whether to treat competing
events as censoring events. When competing events are treated as censoring events,
risks under different interventions are calculated under elimination of
competing events, and are obtained by the Kaplan\textendash{}Meier estimator.
When competing events are not treated as censoring events, risks under different interventions are calculated without elimination of
competing events, and are obtained by using an estimate of the subdistribution cumulative incidence function \sphinxstepexplicit %
\begin{footnote}[1]\phantomsection\label{\thesphinxscope.1}%
\sphinxAtStartFootnote
Young JG, Stensrud MJ, Tchetgen Tchetgen EJ, Hernán MA. A causal framework for classical statistical estimands
in failure\sphinxhyphen{}time settings with competing events. Statistics in Medicine. 2020;39:1199\sphinxhyphen{}236.
%
\end{footnote} \sphinxstepexplicit %
\begin{footnote}[2]\phantomsection\label{\thesphinxscope.2}%
\sphinxAtStartFootnote
Fine JP and Gray RJ. A proportional hazards model for the subdistribution of a competing risk. Journal of the American Statistical Association, 94(446):496\textendash{}509, 1999.
%
\end{footnote}.

\sphinxAtStartPar
The arguments for competing events:


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Arguments
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
\\
\hline
\sphinxAtStartPar
compevent\_name
&
\sphinxAtStartPar
(Optional) A string specifying the name of the competing event variable in obs\_data. Only applicable for survival outcomes..
\\
\hline
\sphinxAtStartPar
compevent\_model
&
\sphinxAtStartPar
(Optional) A string specifying the model statement for the competing event variable. Only applicable for survival outcomes.
\\
\hline
\sphinxAtStartPar
compevent\_cens
&
\sphinxAtStartPar
(Optional) A boolean value indicating whether to treat competing events as censoring events.
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
\sphinxstylestrong{Sample syntax}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{compevent\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{compevent\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D \PYGZti{} A + L1 + L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{compevent\PYGZus{}cens} \PYG{o}{=} \PYG{k+kc}{False}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{compevent\PYGZus{}name} \PYG{o}{=} \PYG{n}{compevent\PYGZus{}name}\PYG{p}{,} \PYG{n}{compevent\PYGZus{}model} \PYG{o}{=} \PYG{n}{compevent\PYGZus{}model}\PYG{p}{,} \PYG{n}{compevent\PYGZus{}cens} \PYG{o}{=} \PYG{n}{compevent\PYGZus{}cens}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
The name of competing event in the input data should be specified in the argument ‘‘compevent\_name’’.
The model statement for the competing event variable should be specified in the argument ‘‘compevent\_model’’.
Users should also specify the argument ‘‘compevent\_cens’’ as True or False indicating whether they want to treat the competing
event as censoring event.

\sphinxAtStartPar
\sphinxstylestrong{Running example} \sphinxhref{https://github.com/CausalInference/pygformula/blob/main/running\_examples/test\_competing\_event.py}{{[}code{]}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{static}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}basicdata}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}basicdata}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bounded normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1 \PYGZti{} lag1\PYGZus{}A + lag2\PYGZus{}A + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} lag1\PYGZus{}A + L1 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2  + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L1 + L2 +lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} A + L1 + L2 + L3 + lag1\PYGZus{}A + lag1\PYGZus{}L1 + lag1\PYGZus{}L2}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{basecovs} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{compevent\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{compevent\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D \PYGZti{} A + L1 + L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{compevent\PYGZus{}cens} \PYG{o}{=} \PYG{k+kc}{False}

\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Never treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Always treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}


\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,}
    \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{Intervention2\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{basecovs} \PYG{o}{=}\PYG{n}{basecovs}\PYG{p}{,} \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,}  \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,}
    \PYG{n}{compevent\PYGZus{}cens}\PYG{o}{=} \PYG{n}{compevent\PYGZus{}cens}\PYG{p}{,} \PYG{n}{compevent\PYGZus{}name} \PYG{o}{=} \PYG{n}{compevent\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{compevent\PYGZus{}model}\PYG{o}{=}\PYG{n}{compevent\PYGZus{}model}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{competing_not_cens_output}.png}\hspace*{\fill}}
\end{quote}

\sphinxAtStartPar
Setting ‘‘compevent\_cens’’ as True:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{compevent\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{compevent\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D \PYGZti{} A + L1 + L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{compevent\PYGZus{}cens} \PYG{o}{=} \PYG{k+kc}{True}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{compevent\PYGZus{}name} \PYG{o}{=} \PYG{n}{compevent\PYGZus{}name}\PYG{p}{,} \PYG{n}{compevent\PYGZus{}model} \PYG{o}{=} \PYG{n}{compevent\PYGZus{}model}\PYG{p}{,} \PYG{n}{compevent\PYGZus{}cens} \PYG{o}{=} \PYG{n}{compevent\PYGZus{}cens}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{competing_as_cens_output}.png}\hspace*{\fill}}
\end{quote}


\section{Hazard ratio}
\label{\detokenize{Specifications/Hazard ratio:hazard-ratio}}\label{\detokenize{Specifications/Hazard ratio:id1}}\label{\detokenize{Specifications/Hazard ratio::doc}}
\sphinxAtStartPar
For survival outcomes, the pygformula provides the option of calculating the hazard ratio comparing any
two interventions of interest. In the presence of competing events, it will return the subdistribution hazard ratio
\sphinxstepexplicit %
\begin{footnote}[1]\phantomsection\label{\thesphinxscope.1}%
\sphinxAtStartFootnote
Fine JP and Gray RJ. A proportional hazards model for the subdistribution of a competing risk. Journal of the American Statistical Association, 94(446):496\textendash{}509, 1999.
%
\end{footnote}. Note that there is an order requirement for the input data structure that it should have the competing event before the outcome event.

\sphinxAtStartPar
\sphinxstyleemphasis{Prerequisite}: If users want to calculate the hazard ratio with competing event, they needs to install additional “rpy2” package
and call the python \sphinxhref{https://pypi.org/project/cmprsk}{“cmprsk”} package. Please follow the steps below to install:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Install R to set up R environment

\item {} 
\sphinxAtStartPar
Install cmprsk R package in R environment:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{install}\PYG{o}{.}\PYG{n}{packages}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{cmprsk}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
Install rpy2 package in python environment:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pip} \PYG{n}{install} \PYG{n}{rpy2}
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
Install cmprsk package in python environment:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pip} \PYG{n}{install} \PYG{n}{cmprsk}
\end{sphinxVerbatim}

\end{itemize}

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
If you encounters the problem of not finding the R environment, you can set up the R path
in your environment using the following command in the code:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{n}{os}\PYG{o}{.}\PYG{n}{environ}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{R\PYGZus{}HOME}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{R\PYGZus{}HOME}\PYG{l+s+s1}{\PYGZsq{}}
\end{sphinxVerbatim}

\sphinxAtStartPar
where R\_HOME is the R home directory path.
\end{quote}
\end{sphinxadmonition}

\sphinxAtStartPar
The argument for calculating the hazard ratio:


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Arguments
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
\\
\hline
\sphinxAtStartPar
intcomp
&
\sphinxAtStartPar
(Optional) List of two numbers indicating a pair of interventions to be compared by a hazard ratio.
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
Users can specify the two interventions by:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{intcomp} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{]}
\end{sphinxVerbatim}

\sphinxAtStartPar
The integer i in ‘‘intcomp’’ denotes the i\sphinxhyphen{}th intervention in the user\sphinxhyphen{}specified interventions. 0 denotes the natural course intervention.

\sphinxAtStartPar
\sphinxstylestrong{Running example} \sphinxhref{https://github.com/CausalInference/pygformula/blob/main/running\_examples/test\_bounded\_normal\_cov.py}{{[}code{]}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{static}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bounded normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} lag1\PYGZus{}A + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
           \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L2 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{basecovs} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} L2 + A + lag1\PYGZus{}A + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}type} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Never treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Always treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,}
    \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,} \PYG{n}{intcomp}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{Intervention2\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,} \PYG{n}{basecovs}\PYG{o}{=}\PYG{n}{basecovs}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}type}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{test_hazard_ratio}.png}\hspace*{\fill}}
\end{quote}


\section{Visit process}
\label{\detokenize{Specifications/Visit process:visit-process}}\label{\detokenize{Specifications/Visit process:id1}}\label{\detokenize{Specifications/Visit process::doc}}
\sphinxAtStartPar
When the data are not recorded at regular intervals, e.g., data are recorded everytime the patient visits the clinic.
Therefore, the times at which the time\sphinxhyphen{}varying covariates are measured will vary by subject. In this setting,
it is typical to construct the data such that (i) at a time when there is no visit/measurement,
the last measured value of a covariate is carried forward, and (ii) a subject is censored after a certain number of consecutive times
with no visit/measurement \sphinxstepexplicit %
\begin{footnote}[1]\phantomsection\label{\thesphinxscope.1}%
\sphinxAtStartFootnote
Hernán MA, McAdams M, McGrath N, Lanoy E, Costagliola D. Observation plans in longitudinal studies with
time\sphinxhyphen{}varying treatments. Statistical Methods in Medical Research 2009;18(1):27\sphinxhyphen{}52.
%
\end{footnote} \sphinxstepexplicit %
\begin{footnote}[2]\phantomsection\label{\thesphinxscope.2}%
\sphinxAtStartFootnote
Young JG, Cain LE, Robins JM, O’Reilly E, Hernán MA. Comparative effectiveness of dynamic treatment regimes:
an application of the parametric g\sphinxhyphen{}formula. Statistics in Biosciences 2011; 3:119\sphinxhyphen{}143.
%
\end{footnote}.

\sphinxAtStartPar
In pygformula, the deterministic knowledge (i) and (ii) can be incorporated via the argument ‘‘visitprocess’’.
Each vector in ‘‘visitprocess’’ contains three parameters that attach a visit process to one covariate.
The first parameter is the name of a time\sphinxhyphen{}varying indicator in the input data set of whether a covariate was measured in each interval
(1 means there is a visit/measurement, 0 means there is no visit/measurement).
The second parameter is the name of the covariate. The third parameter is the maximum number s of missed measurements of this covariate allowed
since the last measurement before a subject is censored.

\sphinxAtStartPar
For the visit indicator, in the fitting step, the probability of a visit is estimated only using records
where the sum of consecutive missed visits through previous k\sphinxhyphen{}1 time points is less than the maximum number of consecutive missed visits s.
Then in the simulation step, if the sum of consecutive missed visits through previous k\sphinxhyphen{}1 time points is less than s, then the visit
indicator is simulated from a distribution based on this estimate; otherwise, the visit indicator is set to 1 so
as to eliminate subjects with more than s consecutive missed visits. For the covariate, in the fitting step, the conditional mean of the covariate will be estimated
only for data records where there is a current visit. If the visit indicator equals 1, then in simulation step, the value of the
dependent covariate will be generated from a distribution based on this estimate; otherwise, the last value is
carried forward.

\sphinxAtStartPar
The argument for visit process:


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Arguments
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
\\
\hline
\sphinxAtStartPar
visitprocess
&
\sphinxAtStartPar
(Optional) List of lists. Each inner list contains its first entry the covariate name of a visit process; its second entry
the name of a covariate whose modeling depends on the visit process; and its third entry the maximum number
of consecutive visits that can be missed before an individual is censored.
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{visit\PYGZus{}cd4}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{visit\PYGZus{}rna}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cd4\PYGZus{}v}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rna\PYGZus{}v}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{everhaart}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{visit\PYGZus{}cd4 \PYGZti{} lag1\PYGZus{}everhaart + lag\PYGZus{}cumavg1\PYGZus{}cd4\PYGZus{}v + sex + race + month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{visit\PYGZus{}rna \PYGZti{} lag1\PYGZus{}everhaart + lag\PYGZus{}cumavg1\PYGZus{}rna\PYGZus{}v + sex + race + month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cd4\PYGZus{}v \PYGZti{} lag1\PYGZus{}everhaart + lag\PYGZus{}cumavg1\PYGZus{}cd4\PYGZus{}v + sex + race + month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rna\PYGZus{}v \PYGZti{} lag1\PYGZus{}everhaart + lag\PYGZus{}cumavg1\PYGZus{}rna\PYGZus{}v + sex + race + month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{everhaart \PYGZti{} lag1\PYGZus{}everhaart + cd4\PYGZus{}v + rna\PYGZus{}v + sex + race + month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{visitprocess} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{visit\PYGZus{}cd4}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cd4\PYGZus{}v}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{visit\PYGZus{}rna}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rna\PYGZus{}v}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{covnames} \PYG{o}{=} \PYG{n}{covnames}\PYG{p}{,} \PYG{n}{covtypes} \PYG{o}{=} \PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels} \PYG{o}{=} \PYG{n}{covmodels}\PYG{p}{,} \PYG{n}{visitprocess} \PYG{o}{=} \PYG{n}{visitprocess}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
Here is an example in clinical cohorts of HIV\sphinxhyphen{}positive patients, ‘‘cd4\_v’’ is a time\sphinxhyphen{}varying covariate of CD4 cell count measurement,
the visit indicator ‘‘visit\_cd4’’ indicats whether the CD4 cell count measurements were taken in interval k.
3 means that the data is constructed such that the subjects are censored once they have not had CD4 measured for 3 consecutive intervals.
Note that for the visit indicator ‘‘visit\_cd4’’, it should come before the dependent covariate ‘‘cd4\_v’’ and be assigned
the ‘‘binary’’ covariate type in ‘‘covtypes’’.

\sphinxAtStartPar
\sphinxstylestrong{Running example}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{static}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}visit\PYGZus{}process}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}visit\PYGZus{}process}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{month}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{visit\PYGZus{}cd4}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{visit\PYGZus{}rna}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cd4\PYGZus{}v}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rna\PYGZus{}v}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{everhaart}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{visit\PYGZus{}cd4 \PYGZti{} lag1\PYGZus{}everhaart + lag\PYGZus{}cumavg1\PYGZus{}cd4\PYGZus{}v + sex + race + month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{visit\PYGZus{}rna \PYGZti{} lag1\PYGZus{}everhaart + lag\PYGZus{}cumavg1\PYGZus{}rna\PYGZus{}v + sex + race + month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cd4\PYGZus{}v \PYGZti{} lag1\PYGZus{}everhaart + lag\PYGZus{}cumavg1\PYGZus{}cd4\PYGZus{}v + sex + race + month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rna\PYGZus{}v \PYGZti{} lag1\PYGZus{}everhaart + lag\PYGZus{}cumavg1\PYGZus{}rna\PYGZus{}v + sex + race + month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{everhaart \PYGZti{} lag1\PYGZus{}everhaart + cd4\PYGZus{}v + rna\PYGZus{}v + sex + race + month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{basecovs} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sex}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{race}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{age}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{visitprocess} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{visit\PYGZus{}cd4}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cd4\PYGZus{}v}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{visit\PYGZus{}rna}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rna\PYGZus{}v}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{]}

\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{event}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{event \PYGZti{} cd4\PYGZus{}v + rna\PYGZus{}v + everhaart + sex + race + month}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}

\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Never treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Always treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}


\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,}  \PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{visitprocess} \PYG{o}{=} \PYG{n}{visitprocess}\PYG{p}{,}
    \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}everhaart} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{Intervention2\PYGZus{}everhaart} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,}  \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,} \PYG{n}{basecovs} \PYG{o}{=} \PYG{n}{basecovs}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{ou} \PYG{n}{tcome\PYGZus{}name}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{visitprocess_example_output}.png}\hspace*{\fill}}
\end{quote}


\section{Deterministic knowledge}
\label{\detokenize{Specifications/Deterministic knowledge:deterministic-knowledge}}\label{\detokenize{Specifications/Deterministic knowledge:id1}}\label{\detokenize{Specifications/Deterministic knowledge::doc}}
\sphinxAtStartPar
When there are known deterministic knowledge, they can be incorporated into the g\sphinxhyphen{}formula algorithm to avoid unnecessary
extrapolation. The package allows users to apply restrictions of the deterministic knowledge on the covariates,
outcome or competing event.


\subsection{Restrictions on covariates}
\label{\detokenize{Specifications/Deterministic knowledge:restrictions-on-covariates}}
\sphinxAtStartPar
When incorporating the deterministic knowledge of one time\sphinxhyphen{}varying covariate Z, the estimation is changed as follows:

\sphinxAtStartPar
1. In step 1 of the algorithm, restrict the chosen method of estimating the mean of Z given
“history” to only records where deterministic knowledge is absent.

\sphinxAtStartPar
2. In step 2 of the algorithm, set Z deterministically to its known value for histories under which this
value is known. Otherwise, draw Z according to the model\sphinxhyphen{}based estimate conditional distribution of Z.

\sphinxAtStartPar
For example, when there are two time\sphinxhyphen{}varying covariates, one indicator of whether an individual has started menopause
by a given interval k (menopause), and another indicator of whether she is pregnant in interval k (pregnancy).
The deterministic knowledge is that given menopause == 1, the probability that pregnancy == 0 is 1. In the first
estimation step, only records with menopause == 0 are used for model estimation of pregnancy. Then in the second
simulation step, if the value of menopause in step 1 at time k is 1 then pregnancy is set to 0. Otherwise, the value
of pregnancy at time k is drawn from the estimated distribution in step 1.

\sphinxAtStartPar
The package allows deterministic knowledge incorporation for covariates by the argument ‘‘restrictions’’:


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Arguments
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
\\
\hline
\sphinxAtStartPar
restrictions
&
\sphinxAtStartPar
(Optional) A list with lists, each inner list contains its first entry the covariate name of that its deterministic knowledge
is known; its second entry is a dictionary whose key is the conditions which should be True when the covariate
is modeled, the third entry is the value that is set to the covariate during simulation when the conditions
in the second entry are not True.
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
Note that for each restricted covariate and its conditional covariates, they need to follow the same order in ‘‘covnames’’, i.e.,
the restricted covariate should be after its conditional covariates.

\sphinxAtStartPar
An example of the restrictions that encodes the relationship between menopause and pregnancy above:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{restrictions} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pregnancy}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{menopause}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{\PYGZcb{}}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{restrictions} \PYG{o}{=} \PYG{n}{restrictions}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Sample syntax}:

\sphinxAtStartPar
An example with one deterministic knowledge conditions for one covariate ‘L2’: if L1 equals 0, L2 is estimated
by its parametric model, otherwise, it is set to a known value 0.5.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{restrictions} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{\PYGZcb{}}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{restrictions} \PYG{o}{=} \PYG{n}{restrictions}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
An example with multiple deterministic knowledge conditions for one covariate ‘A’: if L1 equals 0 and L2 is greater than 0.5, A is estimated
by its parametric model, otherwise, it is set to a known value 1.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{restrictions} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{\PYGZgt{}} \PYG{l+m+mf}{0.5}\PYG{p}{\PYGZcb{}}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{restrictions} \PYG{o}{=} \PYG{n}{restrictions}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
An example with multiple restrictions, one for covariate L1 and one for covariate A:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{restrictions} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{\PYGZcb{}}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{\PYGZgt{}} \PYG{l+m+mf}{0.5}\PYG{p}{\PYGZcb{}}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{restrictions} \PYG{o}{=} \PYG{n}{restrictions}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
If the assigned value of the covariate is not a static value, but determined by a user\sphinxhyphen{}specified function,
the ‘‘restrictions’’ allows an input as a function type. In this case, the third entry for a restriction is a function
instead of a value.

\sphinxAtStartPar
For each custom restriction function, the input should be the parameters (not necessary to use all):
\begin{itemize}
\item {} 
\sphinxAtStartPar
new\_df: A DataFrame that contains data table at current time t.

\item {} 
\sphinxAtStartPar
pool: A DataFrame that contains data table up to time t.

\item {} 
\sphinxAtStartPar
time\_name: A string specifying the name of the time variable in pool.

\item {} 
\sphinxAtStartPar
t: An integer specifying the current time index.

\end{itemize}

\sphinxAtStartPar
The function output should be a list of values that users wish to assign for the restricted covariate at time t.
The package will automatically assign these values for records that are not restricted by the conditions.

\sphinxAtStartPar
An example with one deterministic knowledge condition for covariate L2: if L1 equals 0, L2 is estimated
by its parametric model, otherwise, its previous value is carried forward.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{carry\PYGZus{}forward}\PYG{p}{(}\PYG{n}{new\PYGZus{}df}\PYG{p}{,} \PYG{n}{pool}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{p}{,} \PYG{n}{t}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{assigned\PYGZus{}values} \PYG{o}{=} \PYG{n}{pool}\PYG{o}{.}\PYG{n}{loc}\PYG{p}{[}\PYG{n}{pool}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]} \PYG{o}{==} \PYG{n}{t}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
    \PYG{k}{return} \PYG{n}{assigned\PYGZus{}values}

\PYG{n}{restrictions} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{\PYGZcb{}}\PYG{p}{,} \PYG{n}{carry\PYGZus{}forward}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{restrictions} \PYG{o}{=} \PYG{n}{restrictions}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Running example} \sphinxhref{https://github.com/CausalInference/pygformula/blob/main/running\_examples/test\_restrictions.py}{{[}code{]}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{static}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1 \PYGZti{} lag1\PYGZus{}L1 + lag1\PYGZus{}A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} L1 + lag1\PYGZus{}L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
              \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} L1 + L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{basecovs} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} L1 + L2 + A}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{c+c1}{\PYGZsh{} define interventions}
\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Never treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Always treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{restrictions} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{\PYGZcb{}}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{\PYGZgt{}} \PYG{l+m+mf}{0.5}\PYG{p}{\PYGZcb{}}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,}
    \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{Intervention2\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,}  \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,} \PYG{n}{basecovs}\PYG{o}{=}\PYG{n}{basecovs}\PYG{p}{,}
    \PYG{n}{restrictions}\PYG{o}{=}\PYG{n}{restrictions}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{restriction_example_output}.png}\hspace*{\fill}}
\end{quote}


\subsection{Restrictions on outcome}
\label{\detokenize{Specifications/Deterministic knowledge:restrictions-on-outcome}}
\sphinxAtStartPar
When there is deterministic knowledge of the outcome variable Y, the package offers the argument
‘‘restrictions’’ to incorporate the knowledge:


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Arguments
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
\\
\hline
\sphinxAtStartPar
yrestrictions
&
\sphinxAtStartPar
(Optional) A list with lists, for each inner list, its first entry is a dictionary whose key is the conditions which
should be True when the outcome is modeled, the second entry is the value that is set to the outcome during
simulation when the conditions in the first entry are not True.
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
\sphinxstylestrong{Sample syntax}:

\sphinxAtStartPar
An example with one deterministic knowledge conditions for outcome Y: if L1 equals 0, the probability of outcome Y is estimated
by its parametric model, otherwise, it is set to value 1.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{yrestrictions} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{\PYGZcb{}}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{yrestrictions} \PYG{o}{=} \PYG{n}{yrestrictions}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
An example with multiple restrcitions for outcome Y: if L1 equals 0,
the probability of outcome Y is estimated by its parametric model, otherwise, it is set to a value 0; if L2 is greater than 0.5,
the probability of outcome Y is estimated by its parametric model, otherwise, it is set to a value 0.1;

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{yrestrictions} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{\PYGZcb{}}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{\PYGZgt{}} \PYG{l+m+mf}{0.5}\PYG{p}{\PYGZcb{}}\PYG{p}{,} \PYG{l+m+mf}{0.1}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{yrestrictions} \PYG{o}{=} \PYG{n}{yrestrictions}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Running example} \sphinxhref{https://github.com/CausalInference/pygformula/blob/main/running\_examples/test\_yrestrictions.py}{{[}code{]}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{static}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}basicdata\PYGZus{}nocomp}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1 \PYGZti{} lag1\PYGZus{}L1 + lag1\PYGZus{}A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} L1 + lag1\PYGZus{}L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
              \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} L1 + L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{basecovs} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} L1 + L2 + A}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{c+c1}{\PYGZsh{} define interventions}
\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Never treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Always treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{yrestrictions} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{\PYGZcb{}}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{\PYGZgt{}} \PYG{l+m+mf}{0.5}\PYG{p}{\PYGZcb{}}\PYG{p}{,} \PYG{l+m+mf}{0.1}\PYG{p}{]}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,}
    \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{Intervention2\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,}  \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,} \PYG{n}{basecovs}\PYG{o}{=}\PYG{n}{basecovs}\PYG{p}{,}
    \PYG{n}{yrestrictions}\PYG{o}{=}\PYG{n}{yrestrictions}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{yrestriction_example_output}.png}\hspace*{\fill}}
\end{quote}


\subsection{Restrictions on competing event}
\label{\detokenize{Specifications/Deterministic knowledge:restrictions-on-competing-event}}
\sphinxAtStartPar
When there is a competing event D and there is known deterministic knowledge of the competing event,
the package offers the argument ‘‘compevent\_restrictions’’ for incorporation:


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Arguments
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
\\
\hline
\sphinxAtStartPar
compevent\_restrictions
&
\sphinxAtStartPar
(Optional) A list with lists, for each inner list, its first entry is a dictionary whose key is the conditions which
should be True when the competing event is modeled, the second entry is the value that is set to the competing
event during simulation when the conditions in the first entry are not True. Only applicable for survival outcomes.
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
\sphinxstylestrong{Sample syntax}:

\sphinxAtStartPar
An example with one deterministic knowledge conditions for competing event D: if L1 equals 0, the probability of competing
event is estimated by its parametric model, otherwise, it is set to a value 1.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{compevent\PYGZus{}restrictions} \PYG{o}{=} \PYG{p}{[}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{\PYGZcb{}}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}
\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{compevent\PYGZus{}restrictions} \PYG{o}{=} \PYG{n}{compevent\PYGZus{}restrictions}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
An example with multiple restrictions for competing event D: if L1 equals 0, the probability of competing
event is estimated by its parametric model, otherwise, it is set to a value 1; if L2 is greater than 0.5,
the probability of competing event is estimated by its parametric model, otherwise,
it is set to a value 0.1;

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{compevent\PYGZus{}restrictions} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{\PYGZcb{}}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{\PYGZgt{}} \PYG{l+m+mf}{0.5}\PYG{p}{\PYGZcb{}}\PYG{p}{,} \PYG{l+m+mf}{0.1}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{compevent\PYGZus{}restrictions} \PYG{o}{=} \PYG{n}{compevent\PYGZus{}restrictions}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Running example} \sphinxhref{https://github.com/CausalInference/pygformula/blob/main/running\_examples/test\_comp\_restrictions.py}{{[}code{]}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{pygformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula} \PYG{k+kn}{import} \PYG{n}{ParametricGformula}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{parametric\PYGZus{}gformula}\PYG{n+nn}{.}\PYG{n+nn}{interventions} \PYG{k+kn}{import} \PYG{n}{static}
\PYG{k+kn}{from} \PYG{n+nn}{pygformula}\PYG{n+nn}{.}\PYG{n+nn}{data} \PYG{k+kn}{import} \PYG{n}{load\PYGZus{}basicdata}

\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{load\PYGZus{}basicdata}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{covnames} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covtypes} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bounded normal}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{binary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{covmodels} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1 \PYGZti{} lag1\PYGZus{}A + lag2\PYGZus{}A + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2 \PYGZti{} lag1\PYGZus{}A + L1 + lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2  + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
             \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A \PYGZti{} lag1\PYGZus{}A + L1 + L2 +lag\PYGZus{}cumavg1\PYGZus{}L1 + lag\PYGZus{}cumavg1\PYGZus{}L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{outcome\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y \PYGZti{} A + L1 + L2 + L3 + lag1\PYGZus{}A + lag1\PYGZus{}L1 + lag1\PYGZus{}L2}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{time\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{outcome\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{basecovs} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{compevent\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{compevent\PYGZus{}model} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D \PYGZti{} A + L1 + L2 + L3 + t0}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{compevent\PYGZus{}cens} \PYG{o}{=} \PYG{k+kc}{False}

\PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{unique}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{[}\PYG{n}{time\PYGZus{}name}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Never treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Always treat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}


\PYG{n}{compevent\PYGZus{}restrictions} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{==} \PYG{l+m+mi}{0}\PYG{p}{\PYGZcb{}}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x} \PYG{o}{\PYGZgt{}} \PYG{l+m+mf}{0.5}\PYG{p}{\PYGZcb{}}\PYG{p}{,} \PYG{l+m+mf}{0.1}\PYG{p}{]}\PYG{p}{]}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data} \PYG{o}{=} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{id\PYGZus{}name} \PYG{o}{=} \PYG{n}{id\PYGZus{}name}\PYG{p}{,} \PYG{n}{time\PYGZus{}points} \PYG{o}{=} \PYG{n}{time\PYGZus{}points}\PYG{p}{,}
    \PYG{n}{time\PYGZus{}name}\PYG{o}{=}\PYG{n}{time\PYGZus{}name}\PYG{p}{,} \PYG{n}{int\PYGZus{}descript} \PYG{o}{=} \PYG{n}{int\PYGZus{}descript}\PYG{p}{,}
    \PYG{n}{Intervention1\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{Intervention2\PYGZus{}A} \PYG{o}{=} \PYG{p}{[}\PYG{n}{static}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ones}\PYG{p}{(}\PYG{n}{time\PYGZus{}points}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{basecovs} \PYG{o}{=}\PYG{n}{basecovs}\PYG{p}{,} \PYG{n}{covnames}\PYG{o}{=}\PYG{n}{covnames}\PYG{p}{,}  \PYG{n}{covtypes}\PYG{o}{=}\PYG{n}{covtypes}\PYG{p}{,} \PYG{n}{covmodels}\PYG{o}{=}\PYG{n}{covmodels}\PYG{p}{,}
    \PYG{n}{compevent\PYGZus{}restrictions} \PYG{o}{=} \PYG{n}{compevent\PYGZus{}restrictions}\PYG{p}{,}
    \PYG{n}{compevent\PYGZus{}cens}\PYG{o}{=} \PYG{n}{compevent\PYGZus{}cens}\PYG{p}{,} \PYG{n}{compevent\PYGZus{}name} \PYG{o}{=} \PYG{n}{compevent\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{compevent\PYGZus{}model}\PYG{o}{=}\PYG{n}{compevent\PYGZus{}model}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}name}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}name}\PYG{p}{,}
    \PYG{n}{outcome\PYGZus{}type}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{survival}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{outcome\PYGZus{}model}\PYG{o}{=}\PYG{n}{outcome\PYGZus{}model}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Output}:
\begin{quote}

\noindent{\hspace*{\fill}\sphinxincludegraphics{{comp_restriction_example_output}.png}\hspace*{\fill}}
\end{quote}


\section{Output}
\label{\detokenize{Specifications/Output:output}}\label{\detokenize{Specifications/Output:id1}}\label{\detokenize{Specifications/Output::doc}}

\subsection{Numerical results}
\label{\detokenize{Specifications/Output:numerical-results}}
\sphinxAtStartPar
The package provides the following outputs:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Data table of g\sphinxhyphen{}formula estimates}: The result table of g\sphinxhyphen{}formula estimates is returned by the fit function, containing (1) the nonparametric estimates
of the natural course risk/mean outcome, (2) the parametric g\sphinxhyphen{}formula estimates of the risk/mean outcome under each user\sphinxhyphen{}specified intervention,
(3) the risk ratio between each intervention and the reference intervention (natural course by default, can be specified in the argument ‘‘ref\_int’’),
(4) the risk difference between each intervention and the reference intervention.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Simulated data table for interventions}: The package gives the simulated data table in the simulation step under
each specified intervention, which can be obtained by:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{sim\PYGZus{}data} \PYG{o}{=} \PYG{n}{g}\PYG{o}{.}\PYG{n}{summary\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sim\PYGZus{}data}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
To get the simulated data under a particular intervention:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{sim\PYGZus{}data} \PYG{o}{=} \PYG{n}{g}\PYG{o}{.}\PYG{n}{summary\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sim\PYGZus{}data}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{n}{intervention\PYGZus{}name}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{The IP weights}: To get the inverse probability weights when there is censoring event:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{ip\PYGZus{}weights} \PYG{o}{=} \PYG{n}{g}\PYG{o}{.}\PYG{n}{summary\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{IP\PYGZus{}weights}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{The fitted models}: The package gives the fitted model for each covariate, outcome, competing event (if applicable), censoring event (if applicable).
First the argument ‘‘model\_fits’’ should be set to True, then the fitted models can be obtained by:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{fitted\PYGZus{}models} \PYG{o}{=} \PYG{n}{g}\PYG{o}{.}\PYG{n}{summary\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{model\PYGZus{}fits\PYGZus{}summary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
To get the fitted model for a particular variable:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{fitted\PYGZus{}model} \PYG{o}{=} \PYG{n}{g}\PYG{o}{.}\PYG{n}{summary\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{model\PYGZus{}fits\PYGZus{}summary}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{n}{variable\PYGZus{}name}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{The coefficients}: The package gives the parameter estimates of all the fitted models, which can be obtained by:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{model\PYGZus{}coeffs} \PYG{o}{=} \PYG{n}{g}\PYG{o}{.}\PYG{n}{summary\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{model\PYGZus{}coeffs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
To get the coefficients of the fitted model for a particular variable, please use:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{model\PYGZus{}coeffs} \PYG{o}{=} \PYG{n}{g}\PYG{o}{.}\PYG{n}{summary\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{model\PYGZus{}coeffs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{n}{variable\PYGZus{}name}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{The standard errors}: The package gives the standard errors of the parameter estimates of all the fitted models, which can be obtained by:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{model\PYGZus{}stderrs} \PYG{o}{=} \PYG{n}{g}\PYG{o}{.}\PYG{n}{summary\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{model\PYGZus{}stderrs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
To get the standard errors of the fitted model for a particular variable, please use:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{model\PYGZus{}stderrs} \PYG{o}{=} \PYG{n}{g}\PYG{o}{.}\PYG{n}{summary\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{model\PYGZus{}stderrs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{n}{variable\PYGZus{}name}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{The variance\sphinxhyphen{}covariance matrices}: The package gives the variance\sphinxhyphen{}covariance matrices of the parameter estimates of all the fitted models,
which can be obtained by:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{model\PYGZus{}vcovs} \PYG{o}{=} \PYG{n}{g}\PYG{o}{.}\PYG{n}{summary\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{model\PYGZus{}vcovs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
To get the variance\sphinxhyphen{}covariance matrix of the parameter estimates of the fitted model for a particular variable, please use:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{model\PYGZus{}vcovs} \PYG{o}{=} \PYG{n}{g}\PYG{o}{.}\PYG{n}{summary\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{model\PYGZus{}vcovs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{n}{variable\PYGZus{}name}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{The root mean square error}: The package gives the RMSE values of the fitted models, which can be obtained by:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{rmses} \PYG{o}{=} \PYG{n}{g}\PYG{o}{.}\PYG{n}{summary\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rmses}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
To get the RMSE of the fitted model for a particular variable, please use:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{rmses} \PYG{o}{=} \PYG{n}{g}\PYG{o}{.}\PYG{n}{summary\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rmses}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{n}{variable\PYGZus{}name}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Nonparametric estimates at each time point}: The package gives the nonparametric estimates of all covariates and risk at each time point for survival outcomes, which can be obtained by:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{obs\PYGZus{}estimates} \PYG{o}{=} \PYG{n}{g}\PYG{o}{.}\PYG{n}{summary\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{obs\PYGZus{}plot}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
To get the nonparametric estimates of a particular variable, e.g., risk, please use:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{obs\PYGZus{}estimates} \PYG{o}{=} \PYG{n}{g}\PYG{o}{.}\PYG{n}{summary\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{obs\PYGZus{}plot}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{risk}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Parametric estimates at each time point}: The package gives the parametric estimates of all covariates and risk at each time point for survival outcomes, which can be obtained by:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{est\PYGZus{}estimates} \PYG{o}{=} \PYG{n}{g}\PYG{o}{.}\PYG{n}{summary\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{est\PYGZus{}plot}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
To get the parametric estimates of a particular variable, e.g., risk, please use:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{est\PYGZus{}estimates} \PYG{o}{=} \PYG{n}{g}\PYG{o}{.}\PYG{n}{summary\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{est\PYGZus{}plot}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{risk}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Hazard ratio}: The package gives hazard ratio value for the two interventions specified, which can be obtained by:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{hazard\PYGZus{}ratio} \PYG{o}{=} \PYG{n}{g}\PYG{o}{.}\PYG{n}{summary\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{hazard\PYGZus{}ratio}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\end{itemize}

\sphinxAtStartPar
The package also implement nonparametric bootstrapping to obtain 95\% confidence intervals for risk/mean estimates
by repeating the algorithm for many bootstrap samples. Users can choose the argument ‘‘nsamples’’ to specify the number of new generated bootstrap samples.
Users may choose the argument ‘‘parallel’’ to parallelize bootstrapping and simulation step under each intervention to
make the algorithm run faster. The argument ‘‘ncores’’ can be used to specify the desired number of CPU cores
in parallarization.

\sphinxAtStartPar
The package provides two ways for calculating the confidence intervals
in argument ‘‘ci\_method’’, ‘‘percentile’’ means using percentile bootstrap method which takes the 2.5th and 97.5th percentiles of the bootstrap estimates to get the 95\% confidence interval,
“normal” means using the normal bootstrap method which uses the the original estimate and
the standard deviation of the bootstrap estimates to get the normal approximation 95\% confidence interval.
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{The g\sphinxhyphen{}formula estimates of bootstrap samples}: The package gives the parametric g\sphinxhyphen{}formula estimates of all
bootstrap samples, which can be obtained by:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{nsamples} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{parallel}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{n\PYGZus{}core}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{ci\PYGZus{}method} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{percentile}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{bootests} \PYG{o}{=} \PYG{n}{g}\PYG{o}{.}\PYG{n}{summary\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bootests}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
To get the parametric g\sphinxhyphen{}formula estimates of a particular bootstrap sample, please use:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{g}\PYG{o}{.}\PYG{n}{summary\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bootests}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sample\PYGZus{}}\PYG{l+s+si}{\PYGZob{}id\PYGZcb{}}\PYG{l+s+s1}{\PYGZus{}estimates}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
where id is the sample id which should be an integer between 0 and ‘‘nsamples’’ \sphinxhyphen{} 1.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{The coefficients of bootstrap samples}: The package gives the parameter estimates of all the fitted models for all generated
bootstrap samples, which can be obtained by:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{nsamples} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{parallel}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{n\PYGZus{}core}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{ci\PYGZus{}method} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{percentile}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{boot\PYGZus{}diag}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{bootcoeffs} \PYG{o}{=} \PYG{n}{g}\PYG{o}{.}\PYG{n}{summary\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bootcoeffs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\end{itemize}

\sphinxAtStartPar
Note that the ‘‘boot\_diag’’ should be set to true when to obtain the coefficients, standard errors or variance\sphinxhyphen{}covariance matrices
of bootstrap samples.
\begin{quote}

\sphinxAtStartPar
To get the coefficients of a particular bootstrap sample, please use:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{g}\PYG{o}{.}\PYG{n}{summary\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bootcoeffs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sample\PYGZus{}}\PYG{l+s+si}{\PYGZob{}id\PYGZcb{}}\PYG{l+s+s1}{\PYGZus{}coeffs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}
\end{quote}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{The standard errors of bootstrap samples}: The package gives the standard errors of the parameter estimates of all the fitted models for all generated
bootstrap samples, which can be obtained by:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{nsamples} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{parallel}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{n\PYGZus{}core}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{ci\PYGZus{}method} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{percentile}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{boot\PYGZus{}diag}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{bootstderrs} \PYG{o}{=} \PYG{n}{g}\PYG{o}{.}\PYG{n}{summary\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bootstderrs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
To get the standard errors of a particular bootstrap sample, please use:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{g}\PYG{o}{.}\PYG{n}{summary\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bootstderrs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sample\PYGZus{}}\PYG{l+s+si}{\PYGZob{}id\PYGZcb{}}\PYG{l+s+s1}{\PYGZus{}stderrs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{The variance\sphinxhyphen{}covariance matrices of bootstrap samples}: The package gives the variance\sphinxhyphen{}covariance matrices of the parameter estimates of all the fitted models for all generated
bootstrap samples, which can be obtained by:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{nsamples} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{p}{,} \PYG{n}{parallel}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{n\PYGZus{}core}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{ci\PYGZus{}method} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{percentile}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{boot\PYGZus{}diag}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{bootvcovs} \PYG{o}{=} \PYG{n}{g}\PYG{o}{.}\PYG{n}{summary\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bootvcovs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
To get the variance\sphinxhyphen{}covariance matrices of a particular bootstrap sample, please use:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{g}\PYG{o}{.}\PYG{n}{summary\PYGZus{}dict}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bootvcovs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sample\PYGZus{}}\PYG{l+s+si}{\PYGZob{}id\PYGZcb{}}\PYG{l+s+s1}{\PYGZus{}vcovs}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\end{itemize}

\sphinxAtStartPar
Note that to get bootstrap results of coefficients, standard errors, and variance\sphinxhyphen{}covariance matrices, the argument
‘‘boot\_diag’’ must be set to True.

\sphinxAtStartPar
All the output results above can be saved by the argument ‘‘save\_results’’, once it is set to True,
results will be saved locally by creating a folder automatically. Users can also specify the folder path by the
argument ‘‘save\_path’’:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{g} \PYG{o}{=} \PYG{n}{ParametricGformula}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{,} \PYG{n}{save\PYGZus{}results} \PYG{o}{=} \PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{save\PYGZus{}path} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{user\PYGZhy{}specified path}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
\sphinxstylestrong{Arguments}:


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Arguments
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
\\
\hline
\sphinxAtStartPar
n\_simul
&
\sphinxAtStartPar
(Optional) An integer indicating the number of subjects for whom to simulate data. The default is the number of subjects in the input data.
\\
\hline
\sphinxAtStartPar
ref\_int
&
\sphinxAtStartPar
(Optional) An integer indicating the intervention to be used as the reference for calculating the end\sphinxhyphen{}of\sphinxhyphen{}follow\sphinxhyphen{}up mean
ratio and mean difference. 0 denotes the natural course, while subsequent integers denote user\sphinxhyphen{}specified
interventions in the order that they are named in interventions.
\\
\hline
\sphinxAtStartPar
nsamples
&
\sphinxAtStartPar
(Optional) An integer specifying the number of bootstrap samples to generate.
\\
\hline
\sphinxAtStartPar
parallel
&
\sphinxAtStartPar
(Optional) A boolean value indicating whether to parallelize simulations of different interventions to multiple cores.
\\
\hline
\sphinxAtStartPar
ncores
&
\sphinxAtStartPar
(Optional) An integer indicating the number of cores used in parallelization. It is set to 1 if not specified by users.
\\
\hline
\sphinxAtStartPar
model\_fits
&
\sphinxAtStartPar
(Optional) A boolean value indicating whether to return the fitted models.
\\
\hline
\sphinxAtStartPar
ci\_method
&
\sphinxAtStartPar
(Optional) A string specifying the method for calculating the bootstrap 95\% confidence intervals, if applicable.
The options are “percentile” and “normal”.
\\
\hline
\sphinxAtStartPar
boot\_diag
&
\sphinxAtStartPar
(Optional) A boolean value indicating whether to return the parametric g\sphinxhyphen{}formula estimates as well as the coefficients,
standard errors, and variance\sphinxhyphen{}covariance matrices of the parameters of the fitted models in the bootstrap samples.
\\
\hline
\sphinxAtStartPar
save\_results
&
\sphinxAtStartPar
(Optional) A boolean value indicating whether to save all the returned results to the save\_path.
\\
\hline
\sphinxAtStartPar
save\_path
&
\sphinxAtStartPar
(Optional) A path to save all the returned results. A folder will be created automatically in the current working directory
if the save\_path is not specified by users.
\\
\hline
\sphinxAtStartPar
seed
&
\sphinxAtStartPar
(Optional) An integar indicating the starting seed for simulations and bootstrapping.
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\subsection{Graphical results}
\label{\detokenize{Specifications/Output:module-pygformula.plot}}\label{\detokenize{Specifications/Output:graphical-results}}\index{module@\spxentry{module}!pygformula.plot@\spxentry{pygformula.plot}}\index{pygformula.plot@\spxentry{pygformula.plot}!module@\spxentry{module}}
\sphinxAtStartPar
The package also provides two plotting functions: “plot\_natural\_course” and “plot\_interventions”.
The plot\_natural\_course function plots the curves of each covariate mean (for all types of outcome) and risk (for survival outcomes only) under g\sphinxhyphen{}formula parametric and
non\sphinxhyphen{}parametric estimation.


\begin{savenotes}\sphinxatlongtablestart\begin{longtable}[c]{\X{1}{2}\X{1}{2}}
\hline

\endfirsthead

\multicolumn{2}{c}%
{\makebox[0pt]{\sphinxtablecontinued{\tablename\ \thetable{} \textendash{} continued from previous page}}}\\
\hline

\endhead

\hline
\multicolumn{2}{r}{\makebox[0pt][r]{\sphinxtablecontinued{continues on next page}}}\\
\endfoot

\endlastfoot

\sphinxAtStartPar
{\hyperref[\detokenize{Specifications/Output:pygformula.plot.plot_natural_course}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{plot\_natural\_course}}}}}(time\_points, covnames, ...)
&
\sphinxAtStartPar
This is an internal function that plots the results comparison of covariate means and risks between non\sphinxhyphen{}parametric estimates and g\sphinxhyphen{}formula parametric estimates.
\\
\hline
\end{longtable}\sphinxatlongtableend\end{savenotes}
\index{plot\_natural\_course() (in module pygformula.plot)@\spxentry{plot\_natural\_course()}\spxextra{in module pygformula.plot}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Specifications/Output:pygformula.plot.plot_natural_course}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pygformula.plot.}}\sphinxbfcode{\sphinxupquote{plot\_natural\_course}}}{\emph{\DUrole{n}{time\_points}}, \emph{\DUrole{n}{covnames}}, \emph{\DUrole{n}{covtypes}}, \emph{\DUrole{n}{time\_name}}, \emph{\DUrole{n}{obs\_data}}, \emph{\DUrole{n}{obs\_means}}, \emph{\DUrole{n}{est\_means}}, \emph{\DUrole{n}{censor}}, \emph{\DUrole{n}{outcome\_type}}, \emph{\DUrole{n}{plot\_name}}, \emph{\DUrole{n}{marker}}, \emph{\DUrole{n}{markersize}}, \emph{\DUrole{n}{linewidth}}, \emph{\DUrole{n}{colors}}, \emph{\DUrole{n}{save\_path}}, \emph{\DUrole{n}{save\_figure}}, \emph{\DUrole{n}{boot\_table}}}{}
\sphinxAtStartPar
This is an internal function that plots the results comparison of covariate means and risks between non\sphinxhyphen{}parametric
estimates and g\sphinxhyphen{}formula parametric estimates.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{time\_points}} (\sphinxstyleliteralemphasis{\sphinxupquote{Int}}) \textendash{} An integer indicating the number of time points to simulate. It is set equal to the maximum number of records
that obs\_data contains for any individual plus 1, if not specified by users.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{covnames}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}) \textendash{} A list of strings specifying the names of the time\sphinxhyphen{}varying covariates in obs\_data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{covtypes}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}) \textendash{} A list of strings specifying the “type” of each time\sphinxhyphen{}varying covariate included in covnames.
The supported types: “binary”, “normal”, “categorical”, “bounded normal”, “zero\sphinxhyphen{}inflated normal”,
“truncated normal”, “absorbing”, “categorical time”, “square time” and “custom”. The list must be the same length
as covnames and in the same order.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{time\_name}} (\sphinxstyleliteralemphasis{\sphinxupquote{Str}}) \textendash{} A string specifying the name of the time variable in obs\_data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{obs\_data}} (\sphinxstyleliteralemphasis{\sphinxupquote{DataFrame}}) \textendash{} A data frame containing the observed data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{obs\_means}} (\sphinxstyleliteralemphasis{\sphinxupquote{Dict}}) \textendash{} A dictionary, where the key is the covariate / risk name and the value is its observational mean at all the time points.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{est\_means}} (\sphinxstyleliteralemphasis{\sphinxupquote{Dict}}) \textendash{} A dictionary, where the key is the covariate / risk name and the value is its parametric mean at all the time points.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{censor}} (\sphinxstyleliteralemphasis{\sphinxupquote{Bool}}) \textendash{} A boolean value indicating the if there is a censoring event.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{outcome\_type}} (\sphinxstyleliteralemphasis{\sphinxupquote{Str}}) \textendash{} A string specifying the “type” of outcome. The possible “types” are: “survival”, “continuous\_eof”, and “binary\_eof”.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{plot\_name}} (\sphinxstyleliteralemphasis{\sphinxupquote{Str}}) \textendash{} A string specifying the name for plotting, which is set to “all”, “risk” or one specific covariate name.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{marker}} (\sphinxstyleliteralemphasis{\sphinxupquote{Str}}) \textendash{} A string used to customize the appearance of points in plotting.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{markersize}} (\sphinxstyleliteralemphasis{\sphinxupquote{Int}}) \textendash{} An integer specifies the size of the markers in plotting.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{linewidth}} (\sphinxstyleliteralemphasis{\sphinxupquote{Float}}) \textendash{} A number that specifies the width of the line in plotting.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{colors}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}) \textendash{} A list that contains two strings, the first specifies the color for plotting nonparametric estimates, the second
specifies the color for plotting the parametric estimates.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{save\_path}} (\sphinxstyleliteralemphasis{\sphinxupquote{Path}}) \textendash{} A path to save all the figure results. A folder will be created automatically in the current working directory
if the save\_path is not specified by users.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{save\_figure}} (\sphinxstyleliteralemphasis{\sphinxupquote{Bool}}) \textendash{} A boolean value indicating whether to save the figure or not.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{boot\_table}} (\sphinxstyleliteralemphasis{\sphinxupquote{DataFrame}}) \textendash{} A DataFrame with nonparametric risk and parametric risks of all interventions.

\end{itemize}

\item[{Return type}] \leavevmode
\sphinxAtStartPar
Nothing is returned, the figure will be shown.

\end{description}\end{quote}

\end{fulllineitems}


\sphinxAtStartPar
The plot\_interventions fucntion plots the curves of risk under interventions of interest (for survival outcomes only).


\begin{savenotes}\sphinxatlongtablestart\begin{longtable}[c]{\X{1}{2}\X{1}{2}}
\hline

\endfirsthead

\multicolumn{2}{c}%
{\makebox[0pt]{\sphinxtablecontinued{\tablename\ \thetable{} \textendash{} continued from previous page}}}\\
\hline

\endhead

\hline
\multicolumn{2}{r}{\makebox[0pt][r]{\sphinxtablecontinued{continues on next page}}}\\
\endfoot

\endlastfoot

\sphinxAtStartPar
{\hyperref[\detokenize{Specifications/Output:pygformula.plot.plot_interventions}]{\sphinxcrossref{\sphinxcode{\sphinxupquote{plot\_interventions}}}}}(time\_points, time\_name, ...)
&
\sphinxAtStartPar
An internal function to plot the risk results comparison of all interventions and the natural course.
\\
\hline
\end{longtable}\sphinxatlongtableend\end{savenotes}
\index{plot\_interventions() (in module pygformula.plot)@\spxentry{plot\_interventions()}\spxextra{in module pygformula.plot}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{Specifications/Output:pygformula.plot.plot_interventions}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{pygformula.plot.}}\sphinxbfcode{\sphinxupquote{plot\_interventions}}}{\emph{\DUrole{n}{time\_points}}, \emph{\DUrole{n}{time\_name}}, \emph{\DUrole{n}{risk\_results}}, \emph{\DUrole{n}{int\_descript}}, \emph{\DUrole{n}{outcome\_type}}, \emph{\DUrole{n}{colors}}, \emph{\DUrole{n}{marker}}, \emph{\DUrole{n}{markersize}}, \emph{\DUrole{n}{linewidth}}, \emph{\DUrole{n}{save\_path}}, \emph{\DUrole{n}{save\_figure}}, \emph{\DUrole{n}{boot\_table}}}{}
\sphinxAtStartPar
An internal function to plot the risk results comparison of all interventions and the natural course.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{time\_points}} (\sphinxstyleliteralemphasis{\sphinxupquote{Int}}) \textendash{} An integer indicating the number of time points to simulate. It is set equal to the maximum number of records
that obs\_data contains for any individual plus 1, if not specified by users.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{time\_name}} (\sphinxstyleliteralemphasis{\sphinxupquote{Str}}) \textendash{} A string specifying the name of the time variable in obs\_data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{risk\_results}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}) \textendash{} A list contains the risk estimates at all the time points of all interventions.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{int\_descript}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}) \textendash{} A list of strings, each describing a user\sphinxhyphen{}specified intervention.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{outcome\_type}} (\sphinxstyleliteralemphasis{\sphinxupquote{Str}}) \textendash{} A string specifying the “type” of outcome. The possible “types” are: “survival”, “continuous\_eof”, and “binary\_eof”.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{colors}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}) \textendash{} A list that contains strings, each of which specifies the color for plotting the risk curve of the intervention.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{marker}} (\sphinxstyleliteralemphasis{\sphinxupquote{Str}}) \textendash{} A string used to customize the appearance of points in plotting.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{markersize}} (\sphinxstyleliteralemphasis{\sphinxupquote{Int}}) \textendash{} An integar specifies the size of the markers in plotting.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{linewidth}} (\sphinxstyleliteralemphasis{\sphinxupquote{Float}}) \textendash{} A number that specifies the width of the line in plotting.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{save\_path}} (\sphinxstyleliteralemphasis{\sphinxupquote{Path}}) \textendash{} A path to save all the figure results. A folder will be created automatically in the current working directory
if the save\_path is not specified by users.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{save\_figure}} (\sphinxstyleliteralemphasis{\sphinxupquote{Bool}}) \textendash{} A boolean value indicating whether to save the figure or not.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{boot\_table}} (\sphinxstyleliteralemphasis{\sphinxupquote{DataFrame}}) \textendash{} A DataFrame with nonparametric risk and parametric risks of all interventions.

\end{itemize}

\item[{Return type}] \leavevmode
\sphinxAtStartPar
Nothing is returned, the figure will be shown.

\end{description}\end{quote}

\end{fulllineitems}


\sphinxAtStartPar
Arguments for plotting:


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Arguments
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
\\
\hline
\sphinxAtStartPar
plot\_name
&
\sphinxAtStartPar
A string specifying the name for plotting, which is set to “all”, “risk” or one specific covariate name. Only
applicable for the plot\_natural\_course function. The default is “all”.
\\
\hline
\sphinxAtStartPar
colors
&
\sphinxAtStartPar
For plot\_natural\_course function, it is a list wth two elements, specifying the non\sphinxhyphen{}parametric estimate curve and parametric curve respectively.
Users can choose colors from \sphinxhref{https://matplotlib.org/stable/gallery/color/named\_colors.html}{matplotlib colors}.
For plot\_interventions function, it is a list wth m elements with m the number of interventions plus 1,
specifying all intervention curves. If not specified, the function will use default colors.
\\
\hline
\sphinxAtStartPar
marker
&
\sphinxAtStartPar
A string used to customize the appearance of points in plotting. Users can also choose markers from
\sphinxhref{https://matplotlib.org/stable/api/markers\_api.html}{matplotlib markers} library.
\\
\hline
\sphinxAtStartPar
markersize
&
\sphinxAtStartPar
An integer specifies the size of the markers in plotting.
\\
\hline
\sphinxAtStartPar
linewidth
&
\sphinxAtStartPar
A number that specifies the width of the line in plotting.
\\
\hline
\sphinxAtStartPar
save\_figure
&
\sphinxAtStartPar
A boolean value indicating whether to save the figure or not.
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
Users can call the ‘plot\_natural\_course’ function by:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{g}\PYG{o}{.}\PYG{n}{plot\PYGZus{}natural\PYGZus{}course}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
Users can call the ‘plot\_interventions’ function by:
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{g}\PYG{o}{.}\PYG{n}{plot\PYGZus{}interventions}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
Note that the plotting functions can only be applied after calling the ‘g.fit’ function.

\sphinxAtStartPar
The figures can be saved by the argument ‘‘save\_figure’’, once it is set to True,
results will be saved locally by creating a folder automatically. If the argument ‘‘save\_path’’ is specified, the figure will be saved to the corresponding folder.

\sphinxAtStartPar
\sphinxstylestrong{Sample syntax}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{g}\PYG{o}{.}\PYG{n}{plot\PYGZus{}natural\PYGZus{}course}\PYG{p}{(}\PYG{n}{plot\PYGZus{}name}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{L1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{colors}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{markersize}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{marker}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{v}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{save\PYGZus{}figure}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\PYG{n}{g}\PYG{o}{.}\PYG{n}{plot\PYGZus{}interventions}\PYG{p}{(}\PYG{n}{colors} \PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{green}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{red}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{yellow}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{markersize}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{marker}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{v}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{save\PYGZus{}figure}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
We recommend setting the ‘‘save\_figure’’ as True if users want to access the figure
when running the package on Linux system.
\end{sphinxadmonition}


\chapter{Datasets}
\label{\detokenize{Datasets:datasets}}\label{\detokenize{Datasets::doc}}
\sphinxAtStartPar
We provide simulation \sphinxhref{https://github.com/CausalInference/pygformula/tree/master/datasets}{“datasets”} for
users to run the different examples in this tutorial.
Additionally, code for replicating all test examples can be found in \sphinxhref{https://github.com/CausalInference/pygformula/tree/master/running\_examples}{“running examples”}.


\chapter{Contact}
\label{\detokenize{Contact:contact}}\label{\detokenize{Contact::doc}}
\sphinxAtStartPar
\sphinxstylestrong{Team members}:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Jing Li, \sphinxhref{mailto:jing\_li@hsph.harvard.edu}{jing\_li@hsph.harvard.edu}

\item {} 
\sphinxAtStartPar
Sophia Rein, \sphinxhref{mailto:srein@hsph.harvard.edu}{srein@hsph.harvard.edu}

\item {} 
\sphinxAtStartPar
Sean McGrath, \sphinxhref{mailto:sean\_mcgrath@g.harvard.edu}{sean\_mcgrath@g.harvard.edu}

\item {} 
\sphinxAtStartPar
Roger Logan, \sphinxhref{mailto:rwlogan@hsph.harvard.edu}{rwlogan@hsph.harvard.edu}

\item {} 
\sphinxAtStartPar
Ryan O’Dea, \sphinxhref{mailto:ryanodea@hsph.harvard.edu}{ryanodea@hsph.harvard.edu}

\item {} 
\sphinxAtStartPar
Miguel Hernán, \sphinxhref{mailto:mhernan@hsph.harvard.edu}{mhernan@hsph.harvard.edu}

\end{itemize}

\sphinxAtStartPar
If you have any questions or suggestions about this package, please feel free to contact us.
As an open\sphinxhyphen{}source project, contributions are highly welcome for any bug reports or
feature suggestions.
\begin{itemize}
\item {} 
\sphinxAtStartPar
Issue reports: if you have any issues, please let us know by opening an \sphinxhref{https://github.com/CausalInference/pygformula/issues}{issue}
on github.

\item {} 
\sphinxAtStartPar
Feature requests: if you want to contribute any new feature implementation, please make a
\sphinxhref{https://github.com/CausalInference/pygformula/pulls}{pull request} to post the feature requests.

\end{itemize}


\renewcommand{\indexname}{Python Module Index}
\begin{sphinxtheindex}
\let\bigletter\sphinxstyleindexlettergroup
\bigletter{p}
\item\relax\sphinxstyleindexentry{pygformula.parametric\_gformula}\sphinxstyleindexpageref{Get Started:\detokenize{module-pygformula.parametric_gformula}}
\item\relax\sphinxstyleindexentry{pygformula.parametric\_gformula.interventions}\sphinxstyleindexpageref{Specifications/Intervention:\detokenize{module-2}}
\item\relax\sphinxstyleindexentry{pygformula.plot}\sphinxstyleindexpageref{Specifications/Output:\detokenize{module-pygformula.plot}}
\end{sphinxtheindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}